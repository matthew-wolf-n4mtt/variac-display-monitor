/* Variac_mjw_1.1.ino 
 * This file is the "N4MTT Variable Voltage and Current 
 * Arduino Sketch"
 * 
 * A modified version Arduino script for the project that 
 * first appeared in the March 2015 issue of the ARRL QEX. 
 * The title of the article is "An Experimenter's Variable 
 * Voltage Transformer". 
 *  
 * The major modifications are: 
 * - Replacment of the floating point math for the the
 *   senors with lookup tables.
 * - Addition of two buttons to enable adjustable current   
 *   Limit.
 *    
 * N4MTT Variable Voltage and Current Arduino Sketch
 * Matthew J. Wolf, N4MTT  <n4mtt@arrl.net>
 * Copyright 2016 Matthew J. Wolf
 *  
 * The N4MTT Variable Voltage and Current Arduino Sketch is 
 * free software: you can  redistribute it and/or modify it 
 * under the terms of the GNU General Public License as 
 * published by the Free Software Foundation, either version 
 * 2 of the License, or (at your option) any later version.
 * 
 * The N4MTT Variable Voltage and Current Arduino Sketch is 
 * distributed in the hope that it will be useful, but 
 * WITHOUT ANY WARRANTY; without even the implied warranty 
 * of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  
 * See the GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public 
 * License along with the N4MTT Variable Voltage and Current 
 * Arduino Sketch.  
 * If not, see <http://www.gnu.org/licenses/>.
 *
 *
 * -Orginal comments from the orginal Ted Drell, W5HEU, 
 *  version of the sketch,
 * 
 * Variac Voltage and Current Monitor
 * Set for a 16x2 LCD display.
 * The circuit:
 *  LCD RS pin to digital pin 7
 *  LCD Enable pin to digital pin 6
 *  LCD D4 pin to digital pin 5
 *  LCD D5 pin to digital pin 4
 *  LCD D6 pin to digital pin 3
 *  LCD D7 pin to digital pin 2
 *  LCD R/W pin to ground
 *  10K resistor:
 *  ends to +5V and ground
 *  wiper to LCD VO pin (pin 3)
 *
 * Library originally added 18 Apr 2008
 * by David A. Mellis
 * library modified 5 Jul 2009
 * by Limor Fried (http://www.ladyada.net)
 * 
 * - End of Ted Drell's, W5HEU Comments
 *
 *
 * The ATMEGA328P does not have A FPU. I replaced the
 * floating point math for the voltage and current 
 * sensor with a lookup tables. The ADC has 1024 possible 
 * values. It is easy to determine all the possible
 * values for each of the ADC values because the range
 * of the senors is known. 
 *
 * I added two buttons so that max current could be 
 * adjustable. The Range for the current is from the
 * MaxCur variable to 0.01 . The max current is saved to 
 * EEPROM when current menu is exited with 5th 
 * push of button A. The max current is restored 
 * when the microprocessor is reset or power cycled.  
 * -1st push A display Menu        - B button exit 
 * -2nd push A Curser on Amp       - B button inc AMP (0 to max)
 * -3rd push A Curser on deci Amp  - B button inc deci Amp
 * -4th push A Curser on centi Amp - B button inc centi Amp
 * -5th Push A exit Menu
 *  -The cursor blinks on the decimal point that is 
 *   changed by buttuon B.
 *
 * I formatted the voltage line on the LCD so that it 
 * stays in the same column on the LCD for all values. 
 * 
 * I used a 5 Amp Variac vs the 3 Amp Variac of the original design.  
 * 
 *  Details of the values for the voltage lookup table.
 *  ADC V(Rounded) V
 *  0    0.00    0.000000
 *  1    0.59    0.586510
 *  2    1.17    1.173020
 *  3    1.76    1.759531
 *  4    2.35    2.346041
 *  5    2.93    2.932551
 *  6    3.52    3.519062
 *  7    4.11    4.105572
 *  8    4.69    4.692082
 *  9    5.28    5.278593
 *  10   5.87    5.865103
 *  11   6.45    6.451613
 *  12   7.04    7.038123
 *  13   7.62    7.624633
 *  14   8.21    8.211143
 *  15   8.80    8.797654
 *  16   9.38    9.384164
 *  17   9.97    9.970675
 *  18   10.56    10.557185
 *  19   11.14    11.143695
 *  20   11.73    11.730206
 *  21   12.32    12.316715
 *  22   12.90    12.903226
 *  23   13.49    13.489736
 *  24   14.08    14.076246
 *  25   14.66    14.662757
 *  26   15.25    15.249267
 *  27   15.84    15.835777
 *  28   16.42    16.422287
 *  29   17.01    17.008799
 *  30   17.60    17.595308
 *  31   18.18    18.181818
 *  32   18.77    18.768328
 *  33   19.35    19.354839
 *  34   19.94    19.941349
 *  35   20.53    20.527859
 *  36   21.11    21.114370
 *  37   21.70    21.700880
 *  38   22.29    22.287390
 *  39   22.87    22.873899
 *  40   23.46    23.460411
 *  41   24.05    24.046921
 *  42   24.63    24.633430
 *  43   25.22    25.219942
 *  44   25.81    25.806452
 *  45   26.39    26.392962
 *  46   26.98    26.979471
 *  47   27.57    27.565983
 *  48   28.15    28.152493
 *  49   28.74    28.739002
 *  50   29.33    29.325514
 *  51   29.91    29.912024
 *  52   30.50    30.498533
 *  53   31.09    31.085045
 *  54   31.67    31.671555
 *  55   32.26    32.258064
 *  56   32.84    32.844574
 *  57   33.43    33.431084
 *  58   34.02    34.017597
 *  59   34.60    34.604107
 *  60   35.19    35.190617
 *  61   35.78    35.777126
 *  62   36.36    36.363636
 *  63   36.95    36.950146
 *  64   37.54    37.536655
 *  65   38.12    38.123169
 *  66   38.71    38.709679
 *  67   39.30    39.296188
 *  68   39.88    39.882698
 *  69   40.47    40.469208
 *  70   41.06    41.055717
 *  71   41.64    41.642227
 *  72   42.23    42.228741
 *  73   42.82    42.815250
 *  74   43.40    43.401760
 *  75   43.99    43.988270
 *  76   44.57    44.574780
 *  77   45.16    45.161289
 *  78   45.75    45.747799
 *  79   46.33    46.334312
 *  80   46.92    46.920822
 *  81   47.51    47.507332
 *  82   48.09    48.093842
 *  83   48.68    48.680351
 *  84   49.27    49.266861
 *  85   49.85    49.853371
 *  86   50.44    50.439884
 *  87   51.03    51.026394
 *  88   51.61    51.612904
 *  89   52.20    52.199413
 *  90   52.79    52.785923
 *  91   53.37    53.372433
 *  92   53.96    53.958942
 *  93   54.55    54.545456
 *  94   55.13    55.131966
 *  95   55.72    55.718475
 *  96   56.30    56.304985
 *  97   56.89    56.891495
 *  98   57.48    57.478004
 *  99   58.06    58.064518
 *  100  58.65    58.651028
 *  101  59.24    59.237537
 *  102  59.82    59.824047
 *  103  60.41    60.410557
 *  104  61.00    60.997066
 *  105  61.58    61.583576
 *  106  62.17    62.170090
 *  107  62.76    62.756599
 *  108  63.34    63.343109
 *  109  63.93    63.929619
 *  110  64.52    64.516129
 *  111  65.10    65.102638
 *  112  65.69    65.689148
 *  113  66.28    66.275658
 *  114  66.86    66.862167
 *  115  67.45    67.448677
 *  116  68.04    68.035194
 *  117  68.62    68.621704
 *  118  69.21    69.208214
 *  119  69.79    69.794724
 *  120  70.38    70.381233
 *  121  70.97    70.967743
 *  122  71.55    71.554253
 *  123  72.14    72.140762
 *  124  72.73    72.727272
 *  125  73.31    73.313782
 *  126  73.90    73.900291
 *  127  74.49    74.486801
 *  128  75.07    75.073311
 *  129  75.66    75.659821
 *  130  76.25    76.246338
 *  131  76.83    76.832848
 *  132  77.42    77.419357
 *  133  78.01    78.005867
 *  134  78.59    78.592377
 *  135  79.18    79.178886
 *  136  79.77    79.765396
 *  137  80.35    80.351906
 *  138  80.94    80.938416
 *  139  81.52    81.524925
 *  140  82.11    82.111435
 *  141  82.70    82.697945
 *  142  83.28    83.284454
 *  143  83.87    83.870964
 *  144  84.46    84.457481
 *  145  85.04    85.043991
 *  146  85.63    85.630501
 *  147  86.22    86.217010
 *  148  86.80    86.803520
 *  149  87.39    87.390030
 *  150  87.98    87.976540
 *  151  88.56    88.563049
 *  152  89.15    89.149559
 *  153  89.74    89.736069
 *  154  90.32    90.322578
 *  155  90.91    90.909088
 *  156  91.50    91.495598
 *  157  92.08    92.082115
 *  158  92.67    92.668625
 *  159  93.26    93.255135
 *  160  93.84    93.841644
 *  161  94.43    94.428154
 *  162  95.01    95.014664
 *  163  95.60    95.601173
 *  164  96.19    96.187683
 *  165  96.77    96.774193
 *  166  97.36    97.360703
 *  167  97.95    97.947212
 *  168  98.53    98.533722
 *  169  99.12    99.120232
 *  170  99.71    99.706741
 *  171  100.29    100.293259
 *  172  100.88    100.879768
 *  173  101.47    101.466278
 *  174  102.05    102.052788
 *  175  102.64    102.639297
 *  176  103.23    103.225807
 *  177  103.81    103.812317
 *  178  104.40    104.398827
 *  179  104.99    104.985336
 *  180  105.57    105.571846
 *  181  106.16    106.158356
 *  182  106.74    106.744865
 *  183  107.33    107.331375
 *  184  107.92    107.917885
 *  185  108.50    108.504402
 *  186  109.09    109.090912
 *  187  109.68    109.677422
 *  188  110.26    110.263931
 *  189  110.85    110.850441
 *  190  111.44    111.436951
 *  191  112.02    112.023460
 *  192  112.61    112.609970
 *  193  113.20    113.196480
 *  194  113.78    113.782990
 *  195  114.37    114.369499
 *  196  114.96    114.956009
 *  197  115.54    115.542519
 *  198  116.13    116.129036
 *  199  116.72    116.715546
 *  200  117.30    117.302055
 *  201  117.89    117.888565
 *  202  118.48    118.475075
 *  203  119.06    119.061584
 *  204  119.65    119.648094
 *  205  120.23    120.234604
 *  206  120.82    120.821114
 *  207  121.41    121.407623
 *  208  121.99    121.994133
 *  209  122.58    122.580643
 *  210  123.17    123.167152
 *  211  123.75    123.753662
 *  212  124.34    124.340179
 *  213  124.93    124.926689
 *  214  125.51    125.513199
 *  215  126.10    126.099709
 *  216  126.69    126.686218
 *  217  127.27    127.272728
 *  218  127.86    127.859238
 *  219  128.45    128.445755
 *  220  129.03    129.032257
 *  221  129.62    129.618774
 *  222  130.21    130.205276
 *  223  130.79    130.791794
 *  224  131.38    131.378296
 *  225  131.96    131.964813
 *  226  132.55    132.551315
 *  227  133.14    133.137833
 *  228  133.72    133.724335
 *  229  134.31    134.310852
 *  230  134.90    134.897354
 *  231  135.48    135.483871
 *  232  136.07    136.070389
 *  233  136.66    136.656891
 *  234  137.24    137.243408
 *  235  137.83    137.829910
 *  236  138.42    138.416428
 *  237  139.00    139.002930
 *  238  139.59    139.589447
 *  239  140.18    140.175949
 *  240  140.76    140.762466
 *  241  141.35    141.348969
 *  242  141.94    141.935486
 *  243  142.52    142.521988
 *  244  143.11    143.108505
 *  245  143.70    143.695007
 *  246  144.28    144.281525
 *  247  144.87    144.868042
 *  248  145.45    145.454544
 *  249  146.04    146.041061
 *  250  146.63    146.627563
 *  251  147.21    147.214081
 *  252  147.80    147.800583
 *  253  148.39    148.387100
 *  254  148.97    148.973602
 *  255  149.56    149.560120
 *  256  150.15    150.146622
 *  257  150.73    150.733139
 *  258  151.32    151.319641
 *  259  151.91    151.906158
 *  260  152.49    152.492676
 *  261  153.08    153.079178
 *  262  153.67    153.665695
 *  263  154.25    154.252197
 *  264  154.84    154.838715
 *  265  155.43    155.425217
 *  266  156.01    156.011734
 *  267  156.60    156.598236
 *  268  157.18    157.184753
 *  269  157.77    157.771255
 *  270  158.36    158.357773
 *  271  158.94    158.944275
 *  272  159.53    159.530792
 *  273  160.12    160.117310
 *  274  160.70    160.703812
 *  275  161.29    161.290329
 *  276  161.88    161.876831
 *  277  162.46    162.463348
 *  278  163.05    163.049850
 *  279  163.64    163.636368
 *  280  164.22    164.222870
 *  281  164.81    164.809387
 *  282  165.40    165.395889
 *  283  165.98    165.982407
 *  284  166.57    166.568909
 *  285  167.16    167.155426
 *  286  167.74    167.741928
 *  287  168.33    168.328445
 *  288  168.91    168.914963
 *  289  169.50    169.501465
 *  290  170.09    170.087982
 *  291  170.67    170.674484
 *  292  171.26    171.261002
 *  293  171.85    171.847504
 *  294  172.43    172.434021
 *  295  173.02    173.020523
 *  296  173.61    173.607040
 *  297  174.19    174.193542
 *  298  174.78    174.780060
 *  299  175.37    175.366562
 *  300  175.95    175.953079
 *  301  176.54    176.539597
 *  302  177.13    177.126099
 *  303  177.71    177.712616
 *  304  178.30    178.299118
 *  305  178.89    178.885635
 *  306  179.47    179.472137
 *  307  180.06    180.058655
 *  308  180.65    180.645157
 *  309  181.23    181.231674
 *  310  181.82    181.818176
 *  311  182.40    182.404694
 *  312  182.99    182.991196
 *  313  183.58    183.577713
 *  314  184.16    184.164230
 *  315  184.75    184.750732
 *  316  185.34    185.337250
 *  317  185.92    185.923752
 *  318  186.51    186.510269
 *  319  187.10    187.096771
 *  320  187.68    187.683289
 *  321  188.27    188.269791
 *  322  188.86    188.856308
 *  323  189.44    189.442810
 *  324  190.03    190.029327
 *  325  190.62    190.615829
 *  326  191.20    191.202347
 *  327  191.79    191.788849
 *  328  192.38    192.375366
 *  329  192.96    192.961884
 *  330  193.55    193.548386
 *  331  194.13    194.134903
 *  332  194.72    194.721405
 *  333  195.31    195.307922
 *  334  195.89    195.894424
 *  335  196.48    196.480942
 *  336  197.07    197.067444
 *  337  197.65    197.653961
 *  338  198.24    198.240463
 *  339  198.83    198.826981
 *  340  199.41    199.413483
 *  341  200.00    200.000000
 *  342  200.59    200.586517
 *  343  201.17    201.173019
 *  344  201.76    201.759537
 *  345  202.35    202.346039
 *  346  202.93    202.932556
 *  347  203.52    203.519058
 *  348  204.11    204.105576
 *  349  204.69    204.692078
 *  350  205.28    205.278595
 *  351  205.87    205.865097
 *  352  206.45    206.451614
 *  353  207.04    207.038116
 *  354  207.62    207.624634
 *  355  208.21    208.211151
 *  356  208.80    208.797653
 *  357  209.38    209.384171
 *  358  209.97    209.970673
 *  359  210.56    210.557190
 *  360  211.14    211.143692
 *  361  211.73    211.730209
 *  362  212.32    212.316711
 *  363  212.90    212.903229
 *  364  213.49    213.489731
 *  365  214.08    214.076248
 *  366  214.66    214.662750
 *  367  215.25    215.249268
 *  368  215.84    215.835770
 *  369  216.42    216.422287
 *  370  217.01    217.008804
 *  371  217.60    217.595306
 *  372  218.18    218.181824
 *  373  218.77    218.768326
 *  374  219.35    219.354843
 *  375  219.94    219.941345
 *  376  220.53    220.527863
 *  377  221.11    221.114365
 *  378  221.70    221.700882
 *  379  222.29    222.287384
 *  380  222.87    222.873901
 *  381  223.46    223.460403
 *  382  224.05    224.046921
 *  383  224.63    224.633438
 *  384  225.22    225.219940
 *  385  225.81    225.806458
 *  386  226.39    226.392960
 *  387  226.98    226.979477
 *  388  227.57    227.565979
 *  389  228.15    228.152496
 *  390  228.74    228.738998
 *  391  229.33    229.325516
 *  392  229.91    229.912018
 *  393  230.50    230.498535
 *  394  231.09    231.085037
 *  395  231.67    231.671555
 *  396  232.26    232.258072
 *  397  232.84    232.844574
 *  398  233.43    233.431091
 *  399  234.02    234.017593
 *  400  234.60    234.604111
 *  401  235.19    235.190613
 *  402  235.78    235.777130
 *  403  236.36    236.363632
 *  404  236.95    236.950150
 *  405  237.54    237.536652
 *  406  238.12    238.123169
 *  407  238.71    238.709671
 *  408  239.30    239.296188
 *  409  239.88    239.882690
 *  410  240.47    240.469208
 *  411  241.06    241.055725
 *  412  241.64    241.642227
 *  413  242.23    242.228745
 *  414  242.82    242.815247
 *  415  243.40    243.401764
 *  416  243.99    243.988266
 *  417  244.57    244.574783
 *  418  245.16    245.161285
 *  419  245.75    245.747803
 *  420  246.33    246.334305
 *  421  246.92    246.920822
 *  422  247.51    247.507324
 *  423  248.09    248.093842
 *  424  248.68    248.680359
 *  425  249.27    249.266861
 *  426  249.85    249.853378
 *  427  250.44    250.439880
 *  428  251.03    251.026398
 *  429  251.61    251.612900
 *  430  252.20    252.199417
 *  431  252.79    252.785919
 *  432  253.37    253.372437
 *  433  253.96    253.958939
 *  434  254.55    254.545456
 *  435  255.13    255.131958
 *  436  255.72    255.718475
 *  437  256.30    256.304993
 *  438  256.89    256.891510
 *  439  257.48    257.477997
 *  440  258.06    258.064514
 *  441  258.65    258.651031
 *  442  259.24    259.237549
 *  443  259.82    259.824036
 *  444  260.41    260.410553
 *  445  261.00    260.997070
 *  446  261.58    261.583588
 *  447  262.17    262.170074
 *  448  262.76    262.756592
 *  449  263.34    263.343109
 *  450  263.93    263.929626
 *  451  264.52    264.516144
 *  452  265.10    265.102631
 *  453  265.69    265.689148
 *  454  266.28    266.275665
 *  455  266.86    266.862183
 *  456  267.45    267.448669
 *  457  268.04    268.035187
 *  458  268.62    268.621704
 *  459  269.21    269.208221
 *  460  269.79    269.794708
 *  461  270.38    270.381226
 *  462  270.97    270.967743
 *  463  271.55    271.554260
 *  464  272.14    272.140778
 *  465  272.73    272.727264
 *  466  273.31    273.313782
 *  467  273.90    273.900299
 *  468  274.49    274.486816
 *  469  275.07    275.073303
 *  470  275.66    275.659821
 *  471  276.25    276.246338
 *  472  276.83    276.832855
 *  473  277.42    277.419342
 *  474  278.01    278.005859
 *  475  278.59    278.592377
 *  476  279.18    279.178894
 *  477  279.77    279.765381
 *  478  280.35    280.351898
 *  479  280.94    280.938416
 *  480  281.52    281.524933
 *  481  282.11    282.111450
 *  482  282.70    282.697937
 *  483  283.28    283.284454
 *  484  283.87    283.870972
 *  485  284.46    284.457489
 *  486  285.04    285.043976
 *  487  285.63    285.630493
 *  488  286.22    286.217010
 *  489  286.80    286.803528
 *  490  287.39    287.390015
 *  491  287.98    287.976532
 *  492  288.56    288.563049
 *  493  289.15    289.149567
 *  494  289.74    289.736084
 *  495  290.32    290.322571
 *  496  290.91    290.909088
 *  497  291.50    291.495605
 *  498  292.08    292.082123
 *  499  292.67    292.668610
 *  500  293.26    293.255127
 *  501  293.84    293.841644
 *  502  294.43    294.428162
 *  503  295.01    295.014648
 *  504  295.60    295.601166
 *  505  296.19    296.187683
 *  506  296.77    296.774200
 *  507  297.36    297.360718
 *  508  297.95    297.947205
 *  509  298.53    298.533722
 *  510  299.12    299.120239
 *  511  299.71    299.706757
 *  512  300.29    300.293243
 *  513  300.88    300.879761
 *  514  301.47    301.466278
 *  515  302.05    302.052795
 *  516  302.64    302.639282
 *  517  303.23    303.225800
 *  518  303.81    303.812317
 *  519  304.40    304.398834
 *  520  304.99    304.985352
 *  521  305.57    305.571838
 *  522  306.16    306.158356
 *  523  306.74    306.744873
 *  524  307.33    307.331390
 *  525  307.92    307.917877
 *  526  308.50    308.504395
 *  527  309.09    309.090912
 *  528  309.68    309.677429
 *  529  310.26    310.263916
 *  530  310.85    310.850433
 *  531  311.44    311.436951
 *  532  312.02    312.023468
 *  533  312.61    312.609985
 *  534  313.20    313.196472
 *  535  313.78    313.782990
 *  536  314.37    314.369507
 *  537  314.96    314.956024
 *  538  315.54    315.542511
 *  539  316.13    316.129028
 *  540  316.72    316.715546
 *  541  317.30    317.302063
 *  542  317.89    317.888550
 *  543  318.48    318.475067
 *  544  319.06    319.061584
 *  545  319.65    319.648102
 *  546  320.23    320.234619
 *  547  320.82    320.821106
 *  548  321.41    321.407623
 *  549  321.99    321.994141
 *  550  322.58    322.580658
 *  551  323.17    323.167145
 *  552  323.75    323.753662
 *  553  324.34    324.340179
 *  554  324.93    324.926697
 *  555  325.51    325.513184
 *  556  326.10    326.099701
 *  557  326.69    326.686218
 *  558  327.27    327.272736
 *  559  327.86    327.859222
 *  560  328.45    328.445740
 *  561  329.03    329.032257
 *  562  329.62    329.618774
 *  563  330.21    330.205292
 *  564  330.79    330.791779
 *  565  331.38    331.378296
 *  566  331.96    331.964813
 *  567  332.55    332.551331
 *  568  333.14    333.137817
 *  569  333.72    333.724335
 *  570  334.31    334.310852
 *  571  334.90    334.897369
 *  572  335.48    335.483856
 *  573  336.07    336.070374
 *  574  336.66    336.656891
 *  575  337.24    337.243408
 *  576  337.83    337.829926
 *  577  338.42    338.416412
 *  578  339.00    339.002930
 *  579  339.59    339.589447
 *  580  340.18    340.175964
 *  581  340.76    340.762451
 *  582  341.35    341.348969
 *  583  341.94    341.935486
 *  584  342.52    342.522003
 *  585  343.11    343.108490
 *  586  343.70    343.695007
 *  587  344.28    344.281525
 *  588  344.87    344.868042
 *  589  345.45    345.454559
 *  590  346.04    346.041046
 *  591  346.63    346.627563
 *  592  347.21    347.214081
 *  593  347.80    347.800598
 *  594  348.39    348.387085
 *  595  348.97    348.973602
 *  596  349.56    349.560120
 *  597  350.15    350.146637
 *  598  350.73    350.733124
 *  599  351.32    351.319641
 *  600  351.91    351.906158
 *  601  352.49    352.492676
 *  602  353.08    353.079193
 *  603  353.67    353.665680
 *  604  354.25    354.252197
 *  605  354.84    354.838715
 *  606  355.43    355.425232
 *  607  356.01    356.011719
 *  608  356.60    356.598236
 *  609  357.18    357.184753
 *  610  357.77    357.771271
 *  611  358.36    358.357758
 *  612  358.94    358.944275
 *  613  359.53    359.530792
 *  614  360.12    360.117310
 *  615  360.70    360.703827
 *  616  361.29    361.290314
 *  617  361.88    361.876831
 *  618  362.46    362.463348
 *  619  363.05    363.049866
 *  620  363.64    363.636353
 *  621  364.22    364.222870
 *  622  364.81    364.809387
 *  623  365.40    365.395905
 *  624  365.98    365.982391
 *  625  366.57    366.568909
 *  626  367.16    367.155426
 *  627  367.74    367.741943
 *  628  368.33    368.328461
 *  629  368.91    368.914948
 *  630  369.50    369.501465
 *  631  370.09    370.087982
 *  632  370.67    370.674500
 *  633  371.26    371.260986
 *  634  371.85    371.847504
 *  635  372.43    372.434021
 *  636  373.02    373.020538
 *  637  373.61    373.607025
 *  638  374.19    374.193542
 *  639  374.78    374.780060
 *  640  375.37    375.366577
 *  641  375.95    375.953064
 *  642  376.54    376.539581
 *  643  377.13    377.126099
 *  644  377.71    377.712616
 *  645  378.30    378.299133
 *  646  378.89    378.885620
 *  647  379.47    379.472137
 *  648  380.06    380.058655
 *  649  380.65    380.645172
 *  650  381.23    381.231659
 *  651  381.82    381.818176
 *  652  382.40    382.404694
 *  653  382.99    382.991211
 *  654  383.58    383.577698
 *  655  384.16    384.164215
 *  656  384.75    384.750732
 *  657  385.34    385.337250
 *  658  385.92    385.923767
 *  659  386.51    386.510254
 *  660  387.10    387.096771
 *  661  387.68    387.683289
 *  662  388.27    388.269806
 *  663  388.86    388.856293
 *  664  389.44    389.442810
 *  665  390.03    390.029327
 *  666  390.62    390.615845
 *  667  391.20    391.202332
 *  668  391.79    391.788849
 *  669  392.38    392.375366
 *  670  392.96    392.961884
 *  671  393.55    393.548401
 *  672  394.13    394.134888
 *  673  394.72    394.721405
 *  674  395.31    395.307922
 *  675  395.89    395.894440
 *  676  396.48    396.480927
 *  677  397.07    397.067444
 *  678  397.65    397.653961
 *  679  398.24    398.240479
 *  680  398.83    398.826965
 *  681  399.41    399.413483
 *  682  400.00    400.000000
 *  683  400.59    400.586517
 *  684  401.17    401.173035
 *  685  401.76    401.759521
 *  686  402.35    402.346039
 *  687  402.93    402.932556
 *  688  403.52    403.519073
 *  689  404.11    404.105560
 *  690  404.69    404.692078
 *  691  405.28    405.278595
 *  692  405.87    405.865112
 *  693  406.45    406.451599
 *  694  407.04    407.038116
 *  695  407.62    407.624634
 *  696  408.21    408.211151
 *  697  408.80    408.797668
 *  698  409.38    409.384155
 *  699  409.97    409.970673
 *  700  410.56    410.557190
 *  701  411.14    411.143707
 *  702  411.73    411.730194
 *  703  412.32    412.316711
 *  704  412.90    412.903229
 *  705  413.49    413.489746
 *  706  414.08    414.076233
 *  707  414.66    414.662750
 *  708  415.25    415.249268
 *  709  415.84    415.835785
 *  710  416.42    416.422302
 *  711  417.01    417.008789
 *  712  417.60    417.595306
 *  713  418.18    418.181824
 *  714  418.77    418.768341
 *  715  419.35    419.354828
 *  716  419.94    419.941345
 *  717  420.53    420.527863
 *  718  421.11    421.114380
 *  719  421.70    421.700867
 *  720  422.29    422.287384
 *  721  422.87    422.873901
 *  722  423.46    423.460419
 *  723  424.05    424.046936
 *  724  424.63    424.633423
 *  725  425.22    425.219940
 *  726  425.81    425.806458
 *  727  426.39    426.392975
 *  728  426.98    426.979462
 *  729  427.57    427.565979
 *  730  428.15    428.152496
 *  731  428.74    428.739014
 *  732  429.33    429.325500
 *  733  429.91    429.912018
 *  734  430.50    430.498535
 *  735  431.09    431.085052
 *  736  431.67    431.671539
 *  737  432.26    432.258057
 *  738  432.84    432.844574
 *  739  433.43    433.431091
 *  740  434.02    434.017609
 *  741  434.60    434.604095
 *  742  435.19    435.190613
 *  743  435.78    435.777130
 *  744  436.36    436.363647
 *  745  436.95    436.950134
 *  746  437.54    437.536652
 *  747  438.12    438.123169
 *  748  438.71    438.709686
 *  749  439.30    439.296173
 *  750  439.88    439.882690
 *  751  440.47    440.469208
 *  752  441.06    441.055725
 *  753  441.64    441.642242
 *  754  442.23    442.228729
 *  755  442.82    442.815247
 *  756  443.40    443.401764
 *  757  443.99    443.988281
 *  758  444.57    444.574768
 *  759  445.16    445.161285
 *  760  445.75    445.747803
 *  761  446.33    446.334320
 *  762  446.92    446.920807
 *  763  447.51    447.507324
 *  764  448.09    448.093842
 *  765  448.68    448.680359
 *  766  449.27    449.266876
 *  767  449.85    449.853363
 *  768  450.44    450.439880
 *  769  451.03    451.026398
 *  770  451.61    451.612915
 *  771  452.20    452.199402
 *  772  452.79    452.785919
 *  773  453.37    453.372437
 *  774  453.96    453.958954
 *  775  454.55    454.545441
 *  776  455.13    455.131958
 *  777  455.72    455.718475
 *  778  456.31    456.304993
 *  779  456.89    456.891510
 *  780  457.48    457.477997
 *  781  458.06    458.064514
 *  782  458.65    458.651031
 *  783  459.24    459.237549
 *  784  459.82    459.824036
 *  785  460.41    460.410553
 *  786  461.00    460.997070
 *  787  461.58    461.583588
 *  788  462.17    462.170074
 *  789  462.76    462.756592
 *  790  463.34    463.343109
 *  791  463.93    463.929626
 *  792  464.52    464.516144
 *  793  465.10    465.102631
 *  794  465.69    465.689148
 *  795  466.28    466.275665
 *  796  466.86    466.862183
 *  797  467.45    467.448669
 *  798  468.04    468.035187
 *  799  468.62    468.621704
 *  800  469.21    469.208221
 *  801  469.79    469.794708
 *  802  470.38    470.381226
 *  803  470.97    470.967743
 *  804  471.55    471.554260
 *  805  472.14    472.140778
 *  806  472.73    472.727264
 *  807  473.31    473.313782
 *  808  473.90    473.900299
 *  809  474.49    474.486816
 *  810  475.07    475.073303
 *  811  475.66    475.659821
 *  812  476.25    476.246338
 *  813  476.83    476.832855
 *  814  477.42    477.419342
 *  815  478.01    478.005859
 *  816  478.59    478.592377
 *  817  479.18    479.178894
 *  818  479.77    479.765381
 *  819  480.35    480.351898
 *  820  480.94    480.938416
 *  821  481.52    481.524933
 *  822  482.11    482.111450
 *  823  482.70    482.697937
 *  824  483.28    483.284454
 *  825  483.87    483.870972
 *  826  484.46    484.457489
 *  827  485.04    485.043976
 *  828  485.63    485.630493
 *  829  486.22    486.217010
 *  830  486.80    486.803528
 *  831  487.39    487.390015
 *  832  487.98    487.976532
 *  833  488.56    488.563049
 *  834  489.15    489.149567
 *  835  489.74    489.736084
 *  836  490.32    490.322571
 *  837  490.91    490.909088
 *  838  491.50    491.495605
 *  839  492.08    492.082123
 *  840  492.67    492.668610
 *  841  493.26    493.255127
 *  842  493.84    493.841644
 *  843  494.43    494.428162
 *  844  495.01    495.014648
 *  845  495.60    495.601166
 *  846  496.19    496.187683
 *  847  496.77    496.774200
 *  848  497.36    497.360718
 *  849  497.95    497.947205
 *  850  498.53    498.533722
 *  851  499.12    499.120239
 *  852  499.71    499.706757
 *  853  500.29    500.293243
 *  854  500.88    500.879761
 *  855  501.47    501.466278
 *  856  502.05    502.052795
 *  857  502.64    502.639282
 *  858  503.23    503.225800
 *  859  503.81    503.812317
 *  860  504.40    504.398834
 *  861  504.99    504.985352
 *  862  505.57    505.571838
 *  863  506.16    506.158356
 *  864  506.74    506.744873
 *  865  507.33    507.331390
 *  866  507.92    507.917877
 *  867  508.50    508.504395
 *  868  509.09    509.090912
 *  869  509.68    509.677429
 *  870  510.26    510.263916
 *  871  510.85    510.850433
 *  872  511.44    511.436951
 *  873  512.02    512.023438
 *  874  512.61    512.609985
 *  875  513.20    513.196472
 *  876  513.78    513.783020
 *  877  514.37    514.369507
 *  878  514.96    514.955994
 *  879  515.54    515.542542
 *  880  516.13    516.129028
 *  881  516.72    516.715515
 *  882  517.30    517.302063
 *  883  517.89    517.888550
 *  884  518.48    518.475098
 *  885  519.06    519.061584
 *  886  519.65    519.648071
 *  887  520.23    520.234619
 *  888  520.82    520.821106
 *  889  521.41    521.407654
 *  890  521.99    521.994141
 *  891  522.58    522.580627
 *  892  523.17    523.167175
 *  893  523.75    523.753662
 *  894  524.34    524.340149
 *  895  524.93    524.926697
 *  896  525.51    525.513184
 *  897  526.10    526.099731
 *  898  526.69    526.686218
 *  899  527.27    527.272705
 *  900  527.86    527.859253
 *  901  528.45    528.445740
 *  902  529.03    529.032288
 *  903  529.62    529.618774
 *  904  530.21    530.205261
 *  905  530.79    530.791809
 *  906  531.38    531.378296
 *  907  531.96    531.964783
 *  908  532.55    532.551331
 *  909  533.14    533.137817
 *  910  533.72    533.724365
 *  911  534.31    534.310852
 *  912  534.90    534.897339
 *  913  535.48    535.483887
 *  914  536.07    536.070374
 *  915  536.66    536.656921
 *  916  537.24    537.243408
 *  917  537.83    537.829895
 *  918  538.42    538.416443
 *  919  539.00    539.002930
 *  920  539.59    539.589417
 *  921  540.18    540.175964
 *  922  540.76    540.762451
 *  923  541.35    541.348999
 *  924  541.94    541.935486
 *  925  542.52    542.521973
 *  926  543.11    543.108521
 *  927  543.70    543.695007
 *  928  544.28    544.281555
 *  929  544.87    544.868042
 *  930  545.45    545.454529
 *  931  546.04    546.041077
 *  932  546.63    546.627563
 *  933  547.21    547.214050
 *  934  547.80    547.800598
 *  935  548.39    548.387085
 *  936  548.97    548.973633
 *  937  549.56    549.560120
 *  938  550.15    550.146606
 *  939  550.73    550.733154
 *  940  551.32    551.319641
 *  941  551.91    551.906128
 *  942  552.49    552.492676
 *  943  553.08    553.079163
 *  944  553.67    553.665710
 *  945  554.25    554.252197
 *  946  554.84    554.838684
 *  947  555.43    555.425232
 *  948  556.01    556.011719
 *  949  556.60    556.598267
 *  950  557.18    557.184753
 *  951  557.77    557.771240
 *  952  558.36    558.357788
 *  953  558.94    558.944275
 *  954  559.53    559.530762
 *  955  560.12    560.117310
 *  956  560.70    560.703796
 *  957  561.29    561.290344
 *  958  561.88    561.876831
 *  959  562.46    562.463318
 *  960  563.05    563.049866
 *  961  563.64    563.636353
 *  962  564.22    564.222900
 *  963  564.81    564.809387
 *  964  565.40    565.395874
 *  965  565.98    565.982422
 *  966  566.57    566.568909
 *  967  567.16    567.155396
 *  968  567.74    567.741943
 *  969  568.33    568.328430
 *  970  568.91    568.914978
 *  971  569.50    569.501465
 *  972  570.09    570.087952
 *  973  570.67    570.674500
 *  974  571.26    571.260986
 *  975  571.85    571.847534
 *  976  572.43    572.434021
 *  977  573.02    573.020508
 *  978  573.61    573.607056
 *  979  574.19    574.193542
 *  980  574.78    574.780029
 *  981  575.37    575.366577
 *  982  575.95    575.953064
 *  983  576.54    576.539612
 *  984  577.13    577.126099
 *  985  577.71    577.712585
 *  986  578.30    578.299133
 *  987  578.89    578.885620
 *  988  579.47    579.472168
 *  989  580.06    580.058655
 *  990  580.65    580.645142
 *  991  581.23    581.231689
 *  992  581.82    581.818176
 *  993  582.40    582.404663
 *  994  582.99    582.991211
 *  995  583.58    583.577698
 *  996  584.16    584.164246
 *  997  584.75    584.750732
 *  998  585.34    585.337219
 *  999  585.92    585.923767
 *  1000 586.51    586.510254
 *  1001 587.10    587.096802
 *  1002 587.68    587.683289
 *  1003 588.27    588.269775
 *  1004 588.86    588.856323
 *  1005 589.44    589.442810
 *  1006 590.03    590.029297
 *  1007 590.62    590.615845
 *  1008 591.20    591.202332
 *  1009 591.79    591.788879
 *  1010 592.38    592.375366
 *  1011 592.96    592.961853
 *  1012 593.55    593.548401
 *  1013 594.13    594.134888
 *  1014 594.72    594.721436
 *  1015 595.31    595.307922
 *  1016 595.89    595.894409
 *  1017 596.48    596.480957
 *  1018 597.07    597.067444
 *  1019 597.65    597.653931
 *  1020 598.24    598.240479
 *  1021 598.83    598.826965
 *  1022 599.41    599.413513
 *  1023 600.00    600.000000
 *
 *  Details of the values for the Current lookup table.
 *  ADC  Current(Rounded) Current
 *  0    0.00    0.000000
 *  1    0.00    0.004888
 *  2    0.01    0.009775
 *  3    0.01    0.014663
 *  4    0.02    0.019550
 *  5    0.02    0.024438
 *  6    0.03    0.029326
 *  7    0.03    0.034213
 *  8    0.04    0.039101
 *  9    0.04    0.043988
 *  10   0.05    0.048876
 *  11   0.05    0.053763
 *  12   0.06    0.058651
 *  13   0.06    0.063539
 *  14   0.07    0.068426
 *  15   0.07    0.073314
 *  16   0.08    0.078201
 *  17   0.08    0.083089
 *  18   0.09    0.087977
 *  19   0.09    0.092864
 *  20   0.10    0.097752
 *  21   0.10    0.102639
 *  22   0.11    0.107527
 *  23   0.11    0.112414
 *  24   0.12    0.117302
 *  25   0.12    0.122190
 *  26   0.13    0.127077
 *  27   0.13    0.131965
 *  28   0.14    0.136852
 *  29   0.14    0.141740
 *  30   0.15    0.146628
 *  31   0.15    0.151515
 *  32   0.16    0.156403
 *  33   0.16    0.161290
 *  34   0.17    0.166178
 *  35   0.17    0.171065
 *  36   0.18    0.175953
 *  37   0.18    0.180841
 *  38   0.19    0.185728
 *  39   0.19    0.190616
 *  40   0.20    0.195503
 *  41   0.20    0.200391
 *  42   0.21    0.205279
 *  43   0.21    0.210166
 *  44   0.22    0.215054
 *  45   0.22    0.219941
 *  46   0.22    0.224829
 *  47   0.23    0.229717
 *  48   0.23    0.234604
 *  49   0.24    0.239492
 *  50   0.24    0.244379
 *  51   0.25    0.249267
 *  52   0.25    0.254154
 *  53   0.26    0.259042
 *  54   0.26    0.263930
 *  55   0.27    0.268817
 *  56   0.27    0.273705
 *  57   0.28    0.278592
 *  58   0.28    0.283480
 *  59   0.29    0.288368
 *  60   0.29    0.293255
 *  61   0.30    0.298143
 *  62   0.30    0.303030
 *  63   0.31    0.307918
 *  64   0.31    0.312805
 *  65   0.32    0.317693
 *  66   0.32    0.322581
 *  67   0.33    0.327468
 *  68   0.33    0.332356
 *  69   0.34    0.337243
 *  70   0.34    0.342131
 *  71   0.35    0.347019
 *  72   0.35    0.351906
 *  73   0.36    0.356794
 *  74   0.36    0.361681
 *  75   0.37    0.366569
 *  76   0.37    0.371457
 *  77   0.38    0.376344
 *  78   0.38    0.381232
 *  79   0.39    0.386119
 *  80   0.39    0.391007
 *  81   0.40    0.395894
 *  82   0.40    0.400782
 *  83   0.41    0.405670
 *  84   0.41    0.410557
 *  85   0.42    0.415445
 *  86   0.42    0.420332
 *  87   0.43    0.425220
 *  88   0.43    0.430108
 *  89   0.43    0.434995
 *  90   0.44    0.439883
 *  91   0.44    0.444770
 *  92   0.45    0.449658
 *  93   0.45    0.454545
 *  94   0.46    0.459433
 *  95   0.46    0.464321
 *  96   0.47    0.469208
 *  97   0.47    0.474096
 *  98   0.48    0.478983
 *  99   0.48    0.483871
 *  100  0.49    0.488759
 *  101  0.49    0.493646
 *  102  0.50    0.498534
 *  103  0.50    0.503421
 *  104  0.51    0.508309
 *  105  0.51    0.513196
 *  106  0.52    0.518084
 *  107  0.52    0.522972
 *  108  0.53    0.527859
 *  109  0.53    0.532747
 *  110  0.54    0.537634
 *  111  0.54    0.542522
 *  112  0.55    0.547410
 *  113  0.55    0.552297
 *  114  0.56    0.557185
 *  115  0.56    0.562072
 *  116  0.57    0.566960
 *  117  0.57    0.571847
 *  118  0.58    0.576735
 *  119  0.58    0.581623
 *  120  0.59    0.586510
 *  121  0.59    0.591398
 *  122  0.60    0.596285
 *  123  0.60    0.601173
 *  124  0.61    0.606061
 *  125  0.61    0.610948
 *  126  0.62    0.615836
 *  127  0.62    0.620723
 *  128  0.63    0.625611
 *  129  0.63    0.630499
 *  130  0.64    0.635386
 *  131  0.64    0.640274
 *  132  0.65    0.645161
 *  133  0.65    0.650049
 *  134  0.65    0.654936
 *  135  0.66    0.659824
 *  136  0.66    0.664712
 *  137  0.67    0.669599
 *  138  0.67    0.674487
 *  139  0.68    0.679374
 *  140  0.68    0.684262
 *  141  0.69    0.689150
 *  142  0.69    0.694037
 *  143  0.70    0.698925
 *  144  0.70    0.703812
 *  145  0.71    0.708700
 *  146  0.71    0.713587
 *  147  0.72    0.718475
 *  148  0.72    0.723363
 *  149  0.73    0.728250
 *  150  0.73    0.733138
 *  151  0.74    0.738025
 *  152  0.74    0.742913
 *  153  0.75    0.747801
 *  154  0.75    0.752688
 *  155  0.76    0.757576
 *  156  0.76    0.762463
 *  157  0.77    0.767351
 *  158  0.77    0.772238
 *  159  0.78    0.777126
 *  160  0.78    0.782014
 *  161  0.79    0.786901
 *  162  0.79    0.791789
 *  163  0.80    0.796676
 *  164  0.80    0.801564
 *  165  0.81    0.806452
 *  166  0.81    0.811339
 *  167  0.82    0.816227
 *  168  0.82    0.821114
 *  169  0.83    0.826002
 *  170  0.83    0.830890
 *  171  0.84    0.835777
 *  172  0.84    0.840665
 *  173  0.85    0.845552
 *  174  0.85    0.850440
 *  175  0.86    0.855327
 *  176  0.86    0.860215
 *  177  0.87    0.865103
 *  178  0.87    0.869990
 *  179  0.87    0.874878
 *  180  0.88    0.879765
 *  181  0.88    0.884653
 *  182  0.89    0.889541
 *  183  0.89    0.894428
 *  184  0.90    0.899316
 *  185  0.90    0.904203
 *  186  0.91    0.909091
 *  187  0.91    0.913979
 *  188  0.92    0.918866
 *  189  0.92    0.923754
 *  190  0.93    0.928641
 *  191  0.93    0.933529
 *  192  0.94    0.938416
 *  193  0.94    0.943304
 *  194  0.95    0.948192
 *  195  0.95    0.953079
 *  196  0.96    0.957967
 *  197  0.96    0.962854
 *  198  0.97    0.967742
 *  199  0.97    0.972630
 *  200  0.98    0.977517
 *  201  0.98    0.982405
 *  202  0.99    0.987292
 *  203  0.99    0.992180
 *  204  1.00    0.997067
 *  205  1.00    1.001955
 *  206  1.01    1.006843
 *  207  1.01    1.011730
 *  208  1.02    1.016618
 *  209  1.02    1.021505
 *  210  1.03    1.026393
 *  211  1.03    1.031281
 *  212  1.04    1.036168
 *  213  1.04    1.041056
 *  214  1.05    1.045943
 *  215  1.05    1.050831
 *  216  1.06    1.055718
 *  217  1.06    1.060606
 *  218  1.07    1.065494
 *  219  1.07    1.070381
 *  220  1.08    1.075269
 *  221  1.08    1.080156
 *  222  1.09    1.085044
 *  223  1.09    1.089932
 *  224  1.09    1.094819
 *  225  1.10    1.099707
 *  226  1.10    1.104594
 *  227  1.11    1.109482
 *  228  1.11    1.114370
 *  229  1.12    1.119257
 *  230  1.12    1.124145
 *  231  1.13    1.129032
 *  232  1.13    1.133920
 *  233  1.14    1.138807
 *  234  1.14    1.143695
 *  235  1.15    1.148583
 *  236  1.15    1.153470
 *  237  1.16    1.158358
 *  238  1.16    1.163245
 *  239  1.17    1.168133
 *  240  1.17    1.173020
 *  241  1.18    1.177908
 *  242  1.18    1.182796
 *  243  1.19    1.187683
 *  244  1.19    1.192571
 *  245  1.20    1.197459
 *  246  1.20    1.202346
 *  247  1.21    1.207234
 *  248  1.21    1.212121
 *  249  1.22    1.217009
 *  250  1.22    1.221896
 *  251  1.23    1.226784
 *  252  1.23    1.231672
 *  253  1.24    1.236559
 *  254  1.24    1.241447
 *  255  1.25    1.246334
 *  256  1.25    1.251222
 *  257  1.26    1.256109
 *  258  1.26    1.260997
 *  259  1.27    1.265885
 *  260  1.27    1.270772
 *  261  1.28    1.275660
 *  262  1.28    1.280547
 *  263  1.29    1.285435
 *  264  1.29    1.290323
 *  265  1.30    1.295210
 *  266  1.30    1.300098
 *  267  1.30    1.304985
 *  268  1.31    1.309873
 *  269  1.31    1.314761
 *  270  1.32    1.319648
 *  271  1.32    1.324536
 *  272  1.33    1.329423
 *  273  1.33    1.334311
 *  274  1.34    1.339198
 *  275  1.34    1.344086
 *  276  1.35    1.348974
 *  277  1.35    1.353861
 *  278  1.36    1.358749
 *  279  1.36    1.363636
 *  280  1.37    1.368524
 *  281  1.37    1.373412
 *  282  1.38    1.378299
 *  283  1.38    1.383187
 *  284  1.39    1.388074
 *  285  1.39    1.392962
 *  286  1.40    1.397849
 *  287  1.40    1.402737
 *  288  1.41    1.407625
 *  289  1.41    1.412512
 *  290  1.42    1.417400
 *  291  1.42    1.422287
 *  292  1.43    1.427175
 *  293  1.43    1.432063
 *  294  1.44    1.436950
 *  295  1.44    1.441838
 *  296  1.45    1.446725
 *  297  1.45    1.451613
 *  298  1.46    1.456501
 *  299  1.46    1.461388
 *  300  1.47    1.466276
 *  301  1.47    1.471163
 *  302  1.48    1.476051
 *  303  1.48    1.480938
 *  304  1.49    1.485826
 *  305  1.49    1.490714
 *  306  1.50    1.495601
 *  307  1.50    1.500489
 *  308  1.51    1.505376
 *  309  1.51    1.510264
 *  310  1.52    1.515152
 *  311  1.52    1.520039
 *  312  1.52    1.524927
 *  313  1.53    1.529814
 *  314  1.53    1.534702
 *  315  1.54    1.539589
 *  316  1.54    1.544477
 *  317  1.55    1.549365
 *  318  1.55    1.554252
 *  319  1.56    1.559140
 *  320  1.56    1.564027
 *  321  1.57    1.568915
 *  322  1.57    1.573803
 *  323  1.58    1.578690
 *  324  1.58    1.583578
 *  325  1.59    1.588465
 *  326  1.59    1.593353
 *  327  1.60    1.598240
 *  328  1.60    1.603128
 *  329  1.61    1.608016
 *  330  1.61    1.612903
 *  331  1.62    1.617791
 *  332  1.62    1.622678
 *  333  1.63    1.627566
 *  334  1.63    1.632454
 *  335  1.64    1.637341
 *  336  1.64    1.642229
 *  337  1.65    1.647116
 *  338  1.65    1.652004
 *  339  1.66    1.656891
 *  340  1.66    1.661779
 *  341  1.67    1.666667
 *  342  1.67    1.671554
 *  343  1.68    1.676442
 *  344  1.68    1.681329
 *  345  1.69    1.686217
 *  346  1.69    1.691105
 *  347  1.70    1.695992
 *  348  1.70    1.700880
 *  349  1.71    1.705767
 *  350  1.71    1.710655
 *  351  1.72    1.715543
 *  352  1.72    1.720430
 *  353  1.73    1.725318
 *  354  1.73    1.730205
 *  355  1.74    1.735093
 *  356  1.74    1.739980
 *  357  1.74    1.744868
 *  358  1.75    1.749756
 *  359  1.75    1.754643
 *  360  1.76    1.759531
 *  361  1.76    1.764418
 *  362  1.77    1.769306
 *  363  1.77    1.774194
 *  364  1.78    1.779081
 *  365  1.78    1.783969
 *  366  1.79    1.788856
 *  367  1.79    1.793744
 *  368  1.80    1.798631
 *  369  1.80    1.803519
 *  370  1.81    1.808407
 *  371  1.81    1.813294
 *  372  1.82    1.818182
 *  373  1.82    1.823069
 *  374  1.83    1.827957
 *  375  1.83    1.832845
 *  376  1.84    1.837732
 *  377  1.84    1.842620
 *  378  1.85    1.847507
 *  379  1.85    1.852395
 *  380  1.86    1.857283
 *  381  1.86    1.862170
 *  382  1.87    1.867058
 *  383  1.87    1.871945
 *  384  1.88    1.876833
 *  385  1.88    1.881720
 *  386  1.89    1.886608
 *  387  1.89    1.891496
 *  388  1.90    1.896383
 *  389  1.90    1.901271
 *  390  1.91    1.906158
 *  391  1.91    1.911046
 *  392  1.92    1.915933
 *  393  1.92    1.920821
 *  394  1.93    1.925709
 *  395  1.93    1.930596
 *  396  1.94    1.935484
 *  397  1.94    1.940372
 *  398  1.95    1.945259
 *  399  1.95    1.950147
 *  400  1.96    1.955034
 *  401  1.96    1.959922
 *  402  1.96    1.964809
 *  403  1.97    1.969697
 *  404  1.97    1.974585
 *  405  1.98    1.979472
 *  406  1.98    1.984360
 *  407  1.99    1.989247
 *  408  1.99    1.994135
 *  409  2.00    1.999022
 *  410  2.00    2.003910
 *  411  2.01    2.008798
 *  412  2.01    2.013685
 *  413  2.02    2.018573
 *  414  2.02    2.023460
 *  415  2.03    2.028348
 *  416  2.03    2.033236
 *  417  2.04    2.038123
 *  418  2.04    2.043011
 *  419  2.05    2.047898
 *  420  2.05    2.052786
 *  421  2.06    2.057673
 *  422  2.06    2.062561
 *  423  2.07    2.067449
 *  424  2.07    2.072336
 *  425  2.08    2.077224
 *  426  2.08    2.082111
 *  427  2.09    2.086999
 *  428  2.09    2.091887
 *  429  2.10    2.096774
 *  430  2.10    2.101662
 *  431  2.11    2.106549
 *  432  2.11    2.111437
 *  433  2.12    2.116324
 *  434  2.12    2.121212
 *  435  2.13    2.126100
 *  436  2.13    2.130987
 *  437  2.14    2.135875
 *  438  2.14    2.140763
 *  439  2.15    2.145650
 *  440  2.15    2.150538
 *  441  2.16    2.155425
 *  442  2.16    2.160313
 *  443  2.17    2.165200
 *  444  2.17    2.170088
 *  445  2.17    2.174976
 *  446  2.18    2.179863
 *  447  2.18    2.184751
 *  448  2.19    2.189638
 *  449  2.19    2.194526
 *  450  2.20    2.199414
 *  451  2.20    2.204301
 *  452  2.21    2.209189
 *  453  2.21    2.214076
 *  454  2.22    2.218964
 *  455  2.22    2.223851
 *  456  2.23    2.228739
 *  457  2.23    2.233627
 *  458  2.24    2.238514
 *  459  2.24    2.243402
 *  460  2.25    2.248289
 *  461  2.25    2.253177
 *  462  2.26    2.258065
 *  463  2.26    2.262952
 *  464  2.27    2.267840
 *  465  2.27    2.272727
 *  466  2.28    2.277615
 *  467  2.28    2.282502
 *  468  2.29    2.287390
 *  469  2.29    2.292278
 *  470  2.30    2.297165
 *  471  2.30    2.302053
 *  472  2.31    2.306940
 *  473  2.31    2.311828
 *  474  2.32    2.316715
 *  475  2.32    2.321603
 *  476  2.33    2.326491
 *  477  2.33    2.331378
 *  478  2.34    2.336266
 *  479  2.34    2.341153
 *  480  2.35    2.346041
 *  481  2.35    2.350929
 *  482  2.36    2.355816
 *  483  2.36    2.360704
 *  484  2.37    2.365591
 *  485  2.37    2.370479
 *  486  2.38    2.375367
 *  487  2.38    2.380254
 *  488  2.39    2.385142
 *  489  2.39    2.390029
 *  490  2.39    2.394917
 *  491  2.40    2.399805
 *  492  2.40    2.404692
 *  493  2.41    2.409580
 *  494  2.41    2.414467
 *  495  2.42    2.419355
 *  496  2.42    2.424242
 *  497  2.43    2.429130
 *  498  2.43    2.434018
 *  499  2.44    2.438905
 *  500  2.44    2.443793
 *  501  2.45    2.448680
 *  502  2.45    2.453568
 *  503  2.46    2.458456
 *  504  2.46    2.463343
 *  505  2.47    2.468231
 *  506  2.47    2.473118
 *  507  2.48    2.478006
 *  508  2.48    2.482893
 *  509  2.49    2.487781
 *  510  2.49    2.492669
 *  511  2.50    2.497556
 *  512  2.50    2.502444
 *  513  2.51    2.507331
 *  514  2.51    2.512219
 *  515  2.52    2.517107
 *  516  2.52    2.521994
 *  517  2.53    2.526882
 *  518  2.53    2.531769
 *  519  2.54    2.536657
 *  520  2.54    2.541544
 *  521  2.55    2.546432
 *  522  2.55    2.551320
 *  523  2.56    2.556207
 *  524  2.56    2.561095
 *  525  2.57    2.565982
 *  526  2.57    2.570870
 *  527  2.58    2.575758
 *  528  2.58    2.580645
 *  529  2.59    2.585533
 *  530  2.59    2.590420
 *  531  2.60    2.595308
 *  532  2.60    2.600195
 *  533  2.61    2.605083
 *  534  2.61    2.609971
 *  535  2.61    2.614858
 *  536  2.62    2.619746
 *  537  2.62    2.624633
 *  538  2.63    2.629521
 *  539  2.63    2.634409
 *  540  2.64    2.639296
 *  541  2.64    2.644184
 *  542  2.65    2.649071
 *  543  2.65    2.653959
 *  544  2.66    2.658847
 *  545  2.66    2.663734
 *  546  2.67    2.668622
 *  547  2.67    2.673509
 *  548  2.68    2.678397
 *  549  2.68    2.683285
 *  550  2.69    2.688172
 *  551  2.69    2.693060
 *  552  2.70    2.697947
 *  553  2.70    2.702835
 *  554  2.71    2.707722
 *  555  2.71    2.712610
 *  556  2.72    2.717498
 *  557  2.72    2.722385
 *  558  2.73    2.727273
 *  559  2.73    2.732160
 *  560  2.74    2.737048
 *  561  2.74    2.741935
 *  562  2.75    2.746823
 *  563  2.75    2.751711
 *  564  2.76    2.756598
 *  565  2.76    2.761486
 *  566  2.77    2.766373
 *  567  2.77    2.771261
 *  568  2.78    2.776149
 *  569  2.78    2.781036
 *  570  2.79    2.785924
 *  571  2.79    2.790811
 *  572  2.80    2.795699
 *  573  2.80    2.800586
 *  574  2.81    2.805474
 *  575  2.81    2.810362
 *  576  2.82    2.815249
 *  577  2.82    2.820137
 *  578  2.83    2.825024
 *  579  2.83    2.829912
 *  580  2.83    2.834800
 *  581  2.84    2.839687
 *  582  2.84    2.844575
 *  583  2.85    2.849462
 *  584  2.85    2.854350
 *  585  2.86    2.859237
 *  586  2.86    2.864125
 *  587  2.87    2.869013
 *  588  2.87    2.873900
 *  589  2.88    2.878788
 *  590  2.88    2.883676
 *  591  2.89    2.888563
 *  592  2.89    2.893451
 *  593  2.90    2.898338
 *  594  2.90    2.903226
 *  595  2.91    2.908113
 *  596  2.91    2.913001
 *  597  2.92    2.917889
 *  598  2.92    2.922776
 *  599  2.93    2.927664
 *  600  2.93    2.932551
 *  601  2.94    2.937439
 *  602  2.94    2.942327
 *  603  2.95    2.947214
 *  604  2.95    2.952102
 *  605  2.96    2.956989
 *  606  2.96    2.961877
 *  607  2.97    2.966764
 *  608  2.97    2.971652
 *  609  2.98    2.976540
 *  610  2.98    2.981427
 *  611  2.99    2.986315
 *  612  2.99    2.991202
 *  613  3.00    2.996090
 *  614  3.00    3.000978
 *  615  3.01    3.005865
 *  616  3.01    3.010753
 *  617  3.02    3.015640
 *  618  3.02    3.020528
 *  619  3.03    3.025415
 *  620  3.03    3.030303
 *  621  3.04    3.035191
 *  622  3.04    3.040078
 *  623  3.04    3.044966
 *  624  3.05    3.049853
 *  625  3.05    3.054741
 *  626  3.06    3.059628
 *  627  3.06    3.064516
 *  628  3.07    3.069404
 *  629  3.07    3.074291
 *  630  3.08    3.079179
 *  631  3.08    3.084066
 *  632  3.09    3.088954
 *  633  3.09    3.093842
 *  634  3.10    3.098729
 *  635  3.10    3.103617
 *  636  3.11    3.108504
 *  637  3.11    3.113392
 *  638  3.12    3.118279
 *  639  3.12    3.123167
 *  640  3.13    3.128055
 *  641  3.13    3.132942
 *  642  3.14    3.137830
 *  643  3.14    3.142718
 *  644  3.15    3.147605
 *  645  3.15    3.152493
 *  646  3.16    3.157380
 *  647  3.16    3.162268
 *  648  3.17    3.167156
 *  649  3.17    3.172043
 *  650  3.18    3.176931
 *  651  3.18    3.181818
 *  652  3.19    3.186706
 *  653  3.19    3.191593
 *  654  3.20    3.196481
 *  655  3.20    3.201369
 *  656  3.21    3.206256
 *  657  3.21    3.211144
 *  658  3.22    3.216031
 *  659  3.22    3.220919
 *  660  3.23    3.225806
 *  661  3.23    3.230694
 *  662  3.24    3.235582
 *  663  3.24    3.240469
 *  664  3.25    3.245357
 *  665  3.25    3.250244
 *  666  3.26    3.255132
 *  667  3.26    3.260020
 *  668  3.26    3.264907
 *  669  3.27    3.269795
 *  670  3.27    3.274682
 *  671  3.28    3.279570
 *  672  3.28    3.284457
 *  673  3.29    3.289345
 *  674  3.29    3.294233
 *  675  3.30    3.299120
 *  676  3.30    3.304008
 *  677  3.31    3.308895
 *  678  3.31    3.313783
 *  679  3.32    3.318671
 *  680  3.32    3.323558
 *  681  3.33    3.328446
 *  682  3.33    3.333333
 *  683  3.34    3.338221
 *  684  3.34    3.343108
 *  685  3.35    3.347996
 *  686  3.35    3.352884
 *  687  3.36    3.357771
 *  688  3.36    3.362659
 *  689  3.37    3.367546
 *  690  3.37    3.372434
 *  691  3.38    3.377322
 *  692  3.38    3.382209
 *  693  3.39    3.387097
 *  694  3.39    3.391984
 *  695  3.40    3.396872
 *  696  3.40    3.401760
 *  697  3.41    3.406647
 *  698  3.41    3.411535
 *  699  3.42    3.416422
 *  700  3.42    3.421310
 *  701  3.43    3.426198
 *  702  3.43    3.431085
 *  703  3.44    3.435973
 *  704  3.44    3.440860
 *  705  3.45    3.445748
 *  706  3.45    3.450635
 *  707  3.46    3.455523
 *  708  3.46    3.460411
 *  709  3.47    3.465298
 *  710  3.47    3.470186
 *  711  3.48    3.475073
 *  712  3.48    3.479961
 *  713  3.48    3.484848
 *  714  3.49    3.489736
 *  715  3.49    3.494624
 *  716  3.50    3.499511
 *  717  3.50    3.504399
 *  718  3.51    3.509286
 *  719  3.51    3.514174
 *  720  3.52    3.519062
 *  721  3.52    3.523949
 *  722  3.53    3.528837
 *  723  3.53    3.533724
 *  724  3.54    3.538612
 *  725  3.54    3.543499
 *  726  3.55    3.548387
 *  727  3.55    3.553275
 *  728  3.56    3.558162
 *  729  3.56    3.563050
 *  730  3.57    3.567937
 *  731  3.57    3.572825
 *  732  3.58    3.577713
 *  733  3.58    3.582600
 *  734  3.59    3.587488
 *  735  3.59    3.592375
 *  736  3.60    3.597263
 *  737  3.60    3.602150
 *  738  3.61    3.607038
 *  739  3.61    3.611926
 *  740  3.62    3.616813
 *  741  3.62    3.621701
 *  742  3.63    3.626589
 *  743  3.63    3.631476
 *  744  3.64    3.636364
 *  745  3.64    3.641251
 *  746  3.65    3.646139
 *  747  3.65    3.651026
 *  748  3.66    3.655914
 *  749  3.66    3.660802
 *  750  3.67    3.665689
 *  751  3.67    3.670577
 *  752  3.68    3.675464
 *  753  3.68    3.680352
 *  754  3.69    3.685240
 *  755  3.69    3.690127
 *  756  3.70    3.695015
 *  757  3.70    3.699902
 *  758  3.70    3.704790
 *  759  3.71    3.709677
 *  760  3.71    3.714565
 *  761  3.72    3.719453
 *  762  3.72    3.724340
 *  763  3.73    3.729228
 *  764  3.73    3.734115
 *  765  3.74    3.739003
 *  766  3.74    3.743891
 *  767  3.75    3.748778
 *  768  3.75    3.753666
 *  769  3.76    3.758553
 *  770  3.76    3.763441
 *  771  3.77    3.768328
 *  772  3.77    3.773216
 *  773  3.78    3.778104
 *  774  3.78    3.782991
 *  775  3.79    3.787879
 *  776  3.79    3.792766
 *  777  3.80    3.797654
 *  778  3.80    3.802541
 *  779  3.81    3.807429
 *  780  3.81    3.812317
 *  781  3.82    3.817204
 *  782  3.82    3.822092
 *  783  3.83    3.826979
 *  784  3.83    3.831867
 *  785  3.84    3.836755
 *  786  3.84    3.841642
 *  787  3.85    3.846530
 *  788  3.85    3.851417
 *  789  3.86    3.856305
 *  790  3.86    3.861192
 *  791  3.87    3.866080
 *  792  3.87    3.870968
 *  793  3.88    3.875855
 *  794  3.88    3.880743
 *  795  3.89    3.885631
 *  796  3.89    3.890518
 *  797  3.90    3.895406
 *  798  3.90    3.900293
 *  799  3.91    3.905181
 *  800  3.91    3.910069
 *  801  3.91    3.914956
 *  802  3.92    3.919844
 *  803  3.92    3.924731
 *  804  3.93    3.929619
 *  805  3.93    3.934506
 *  806  3.94    3.939394
 *  807  3.94    3.944282
 *  808  3.95    3.949169
 *  809  3.95    3.954057
 *  810  3.96    3.958944
 *  811  3.96    3.963832
 *  812  3.97    3.968719
 *  813  3.97    3.973607
 *  814  3.98    3.978495
 *  815  3.98    3.983382
 *  816  3.99    3.988270
 *  817  3.99    3.993157
 *  818  4.00    3.998045
 *  819  4.00    4.002933
 *  820  4.01    4.007820
 *  821  4.01    4.012708
 *  822  4.02    4.017595
 *  823  4.02    4.022483
 *  824  4.03    4.027370
 *  825  4.03    4.032258
 *  826  4.04    4.037146
 *  827  4.04    4.042033
 *  828  4.05    4.046921
 *  829  4.05    4.051808
 *  830  4.06    4.056696
 *  831  4.06    4.061584
 *  832  4.07    4.066471
 *  833  4.07    4.071359
 *  834  4.08    4.076246
 *  835  4.08    4.081134
 *  836  4.09    4.086021
 *  837  4.09    4.090909
 *  838  4.10    4.095797
 *  839  4.10    4.100684
 *  840  4.11    4.105572
 *  841  4.11    4.110459
 *  842  4.12    4.115347
 *  843  4.12    4.120234
 *  844  4.13    4.125122
 *  845  4.13    4.130010
 *  846  4.13    4.134897
 *  847  4.14    4.139785
 *  848  4.14    4.144672
 *  849  4.15    4.149560
 *  850  4.15    4.154448
 *  851  4.16    4.159335
 *  852  4.16    4.164223
 *  853  4.17    4.169110
 *  854  4.17    4.173998
 *  855  4.18    4.178885
 *  856  4.18    4.183773
 *  857  4.19    4.188661
 *  858  4.19    4.193548
 *  859  4.20    4.198436
 *  860  4.20    4.203323
 *  861  4.21    4.208211
 *  862  4.21    4.213099
 *  863  4.22    4.217986
 *  864  4.22    4.222874
 *  865  4.23    4.227761
 *  866  4.23    4.232649
 *  867  4.24    4.237536
 *  868  4.24    4.242424
 *  869  4.25    4.247312
 *  870  4.25    4.252200
 *  871  4.26    4.257087
 *  872  4.26    4.261975
 *  873  4.27    4.266862
 *  874  4.27    4.271750
 *  875  4.28    4.276638
 *  876  4.28    4.281525
 *  877  4.29    4.286413
 *  878  4.29    4.291300
 *  879  4.30    4.296188
 *  880  4.30    4.301075
 *  881  4.31    4.305963
 *  882  4.31    4.310851
 *  883  4.32    4.315738
 *  884  4.32    4.320626
 *  885  4.33    4.325513
 *  886  4.33    4.330401
 *  887  4.34    4.335289
 *  888  4.34    4.340176
 *  889  4.35    4.345064
 *  890  4.35    4.349951
 *  891  4.35    4.354839
 *  892  4.36    4.359726
 *  893  4.36    4.364614
 *  894  4.37    4.369502
 *  895  4.37    4.374389
 *  896  4.38    4.379277
 *  897  4.38    4.384164
 *  898  4.39    4.389052
 *  899  4.39    4.393939
 *  900  4.40    4.398827
 *  901  4.40    4.403715
 *  902  4.41    4.408602
 *  903  4.41    4.413490
 *  904  4.42    4.418377
 *  905  4.42    4.423265
 *  906  4.43    4.428153
 *  907  4.43    4.433040
 *  908  4.44    4.437928
 *  909  4.44    4.442815
 *  910  4.45    4.447703
 *  911  4.45    4.452590
 *  912  4.46    4.457478
 *  913  4.46    4.462366
 *  914  4.47    4.467253
 *  915  4.47    4.472141
 *  916  4.48    4.477028
 *  917  4.48    4.481916
 *  918  4.49    4.486804
 *  919  4.49    4.491691
 *  920  4.50    4.496579
 *  921  4.50    4.501466
 *  922  4.51    4.506354
 *  923  4.51    4.511241
 *  924  4.52    4.516129
 *  925  4.52    4.521017
 *  926  4.53    4.525904
 *  927  4.53    4.530792
 *  928  4.54    4.535679
 *  929  4.54    4.540567
 *  930  4.55    4.545455
 *  931  4.55    4.550342
 *  932  4.56    4.555230
 *  933  4.56    4.560117
 *  934  4.57    4.565005
 *  935  4.57    4.569892
 *  936  4.57    4.574780
 *  937  4.58    4.579668
 *  938  4.58    4.584555
 *  939  4.59    4.589443
 *  940  4.59    4.594330
 *  941  4.60    4.599218
 *  942  4.60    4.604105
 *  943  4.61    4.608993
 *  944  4.61    4.613881
 *  945  4.62    4.618768
 *  946  4.62    4.623656
 *  947  4.63    4.628543
 *  948  4.63    4.633431
 *  949  4.64    4.638319
 *  950  4.64    4.643206
 *  951  4.65    4.648094
 *  952  4.65    4.652981
 *  953  4.66    4.657869
 *  954  4.66    4.662756
 *  955  4.67    4.667644
 *  956  4.67    4.672532
 *  957  4.68    4.677419
 *  958  4.68    4.682307
 *  959  4.69    4.687194
 *  960  4.69    4.692082
 *  961  4.70    4.696970
 *  962  4.70    4.701857
 *  963  4.71    4.706745
 *  964  4.71    4.711632
 *  965  4.72    4.716520
 *  966  4.72    4.721407
 *  967  4.73    4.726295
 *  968  4.73    4.731183
 *  969  4.74    4.736070
 *  970  4.74    4.740958
 *  971  4.75    4.745845
 *  972  4.75    4.750733
 *  973  4.76    4.755621
 *  974  4.76    4.760509
 *  975  4.77    4.765396
 *  976  4.77    4.770284
 *  977  4.78    4.775171
 *  978  4.78    4.780059
 *  979  4.78    4.784946
 *  980  4.79    4.789834
 *  981  4.79    4.794722
 *  982  4.80    4.799609
 *  983  4.80    4.804497
 *  984  4.81    4.809384
 *  985  4.81    4.814272
 *  986  4.82    4.819160
 *  987  4.82    4.824047
 *  988  4.83    4.828935
 *  989  4.83    4.833822
 *  990  4.84    4.838710
 *  991  4.84    4.843597
 *  992  4.85    4.848485
 *  993  4.85    4.853373
 *  994  4.86    4.858260
 *  995  4.86    4.863148
 *  996  4.87    4.868035
 *  997  4.87    4.872923
 *  998  4.88    4.877810
 *  999  4.88    4.882698
 *  1000 4.89    4.887586
 *  1001 4.89    4.892473
 *  1002 4.90    4.897361
 *  1003 4.90    4.902248
 *  1004 4.91    4.907136
 *  1005 4.91    4.912024
 *  1006 4.92    4.916911
 *  1007 4.92    4.921799
 *  1008 4.93    4.926686
 *  1009 4.93    4.931574
 *  1010 4.94    4.936461
 *  1011 4.94    4.941349
 *  1012 4.95    4.946237
 *  1013 4.95    4.951124
 *  1014 4.96    4.956012
 *  1015 4.96    4.960899
 *  1016 4.97    4.965787
 *  1017 4.97    4.970675
 *  1018 4.98    4.975562
 *  1019 4.98    4.980450
 *  1020 4.99    4.985337
 *  1021 4.99    4.990225
 *  1022 5.00    4.995112
 *  1023 5.00    5.000000
*/

// Include the library code:
#include <LiquidCrystal.h>
#include <EEPROM.h>
#include <math.h>

// Initialize the library with the numbers of the interface pins
LiquidCrystal lcd(7, 6, 5, 4, 3, 2);

// Voltage lookup table
const float vol_table[] PROGMEM = {
  0.00, 0.59, 1.17, 1.76, 2.35, 2.93, 3.52, 4.11, 4.69, 5.28, 5.87,
  6.45, 7.04, 7.62, 8.21, 8.80, 9.38, 9.97, 10.56, 11.14, 11.73,
  12.32, 12.90, 13.49, 14.08, 14.66, 15.25, 15.84, 16.42, 17.01, 17.60,
  18.18, 18.77, 19.35, 19.94, 20.53, 21.11, 21.70, 22.29, 22.87, 23.46,
  24.05, 24.63, 25.22, 25.81, 26.39, 26.98, 27.57, 28.15, 28.74, 29.33,
  29.91, 30.50, 31.09, 31.67, 32.26, 32.84, 33.43, 34.02, 34.60, 35.19,
  35.78, 36.36, 36.95, 37.54, 38.12, 38.71, 39.30, 39.88, 40.47, 41.06,
  41.64, 42.23, 42.82, 43.40, 43.99, 44.57, 45.16, 45.75, 46.33, 46.92,
  47.51, 48.09, 48.68, 49.27, 49.85, 50.44, 51.03, 51.61, 52.20, 52.79,
  53.37, 53.96, 54.55, 55.13, 55.72, 56.30, 56.89, 57.48, 58.06, 58.65,
  59.24, 59.82, 60.41, 61.00, 61.58, 62.17, 62.76, 63.34, 63.93, 64.52,
  65.10, 65.69, 66.28, 66.86, 67.45, 68.04, 68.62, 69.21, 69.79, 70.38,
  70.97, 71.55, 72.14, 72.73, 73.31, 73.90, 74.49, 75.07, 75.66, 76.25,
  76.83, 77.42, 78.01, 78.59, 79.18, 79.77, 80.35, 80.94, 81.52, 82.11,
  82.70, 83.28, 83.87, 84.46, 85.04, 85.63, 86.22, 86.80, 87.39, 87.98,
  88.56, 89.15, 89.74, 90.32, 90.91, 91.50, 92.08, 92.67, 93.26, 93.84,
  94.43, 95.01, 95.60, 96.19, 96.77, 97.36, 97.95, 98.53, 99.12, 99.71,
  100.29, 100.88, 101.47, 102.05, 102.64, 103.23, 103.81, 104.40, 104.99, 105.57,
  106.16, 106.74, 107.33, 107.92, 108.50, 109.09, 109.68, 110.26, 110.85, 111.44,
  112.02, 112.61, 113.20, 113.78, 114.37, 114.96, 115.54, 116.13, 116.72, 117.30,
  117.89, 118.48, 119.06, 119.65, 120.23, 120.82, 121.41, 121.99, 122.58, 123.17,
  123.75, 124.34, 124.93, 125.51, 126.10, 126.69, 127.27, 127.86, 128.45, 129.03,
  129.62, 130.21, 130.79, 131.38, 131.96, 132.55, 133.14, 133.72, 134.31, 134.90,
  135.48, 136.07, 136.66, 137.24, 137.83, 138.42, 139.00, 139.59, 140.18, 140.76,
  141.35, 141.94, 142.52, 143.11, 143.70, 144.28, 144.87, 145.45, 146.04, 146.63,
  147.21, 147.80, 148.39, 148.97, 149.56, 150.15, 150.73, 151.32, 151.91, 152.49,
  153.08, 153.67, 154.25, 154.84, 155.43, 156.01, 156.60, 157.18, 157.77, 158.36,
  158.94, 159.53, 160.12, 160.70, 161.29, 161.88, 162.46, 163.05, 163.64, 164.22,
  164.81, 165.40, 165.98, 166.57, 167.16, 167.74, 168.33, 168.91, 169.50, 170.09,
  170.67, 171.26, 171.85, 172.43, 173.02, 173.61, 174.19, 174.78, 175.37, 175.95,
  176.54, 177.13, 177.71, 178.30, 178.89, 179.47, 180.06, 180.65, 181.23, 181.82,
  182.40, 182.99, 183.58, 184.16, 184.75, 185.34, 185.92, 186.51, 187.10, 187.68,
  188.27, 188.86, 189.44, 190.03, 190.62, 191.20, 191.79, 192.38, 192.96, 193.55,
  194.13, 194.72, 195.31, 195.89, 196.48, 197.07, 197.65, 198.24, 198.83, 199.41,
  200.00, 200.59, 201.17, 201.76, 202.35, 202.93, 203.52, 204.11, 204.69, 205.28,
  205.87, 206.45, 207.04, 207.62, 208.21, 208.80, 209.38, 209.97, 210.56, 211.14,
  211.73, 212.32, 212.90, 213.49, 214.08, 214.66, 215.25, 215.84, 216.42, 217.01,
  217.60, 218.18, 218.77, 219.35, 219.94, 220.53, 221.11, 221.70, 222.29, 222.87,
  223.46, 224.05, 224.63, 225.22, 225.81, 226.39, 226.98, 227.57, 228.15, 228.74,
  229.33, 229.91, 230.50, 231.09, 231.67, 232.26, 232.84, 233.43, 234.02, 234.60,
  235.19, 235.78, 236.36, 236.95, 237.54, 238.12, 238.71, 239.30, 239.88, 240.47,
  241.06, 241.64, 242.23, 242.82, 243.40, 243.99, 244.57, 245.16, 245.75, 246.33,
  246.92, 247.51, 248.09, 248.68, 249.27, 249.85, 250.44, 251.03, 251.61, 252.20,
  252.79, 253.37, 253.96, 254.55, 255.13, 255.72, 256.30, 256.89, 257.48, 258.06,
  258.65, 259.24, 259.82, 260.41, 261.00, 261.58, 262.17, 262.76, 263.34, 263.93,
  264.52, 265.10, 265.69, 266.28, 266.86, 267.45, 268.04, 268.62, 269.21, 269.79,
  270.38, 270.97, 271.55, 272.14, 272.73, 273.31, 273.90, 274.49, 275.07, 275.66,
  276.25, 276.83, 277.42, 278.01, 278.59, 279.18, 279.77, 280.35, 280.94, 281.52,
  282.11, 282.70, 283.28, 283.87, 284.46, 285.04, 285.63, 286.22, 286.80, 287.39,
  287.98, 288.56, 289.15, 289.74, 290.32, 290.91, 291.50, 292.08, 292.67, 293.26,
  293.84, 294.43, 295.01, 295.60, 296.19, 296.77, 297.36, 297.95, 298.53, 299.12,
  299.71, 300.29, 300.88, 301.47, 302.05, 302.64, 303.23, 303.81, 304.40, 304.99,
  305.57, 306.16, 306.74, 307.33, 307.92, 308.50, 309.09, 309.68, 310.26, 310.85,
  311.44, 312.02, 312.61, 313.20, 313.78, 314.37, 314.96, 315.54, 316.13, 316.72,
  317.30, 317.89, 318.48, 319.06, 319.65, 320.23, 320.82, 321.41, 321.99, 322.58,
  323.17, 323.75, 324.34, 324.93, 325.51, 326.10, 326.69, 327.27, 327.86, 328.45,
  329.03, 329.62, 330.21, 330.79, 331.38, 331.96, 332.55, 333.14, 333.72, 334.31,
  334.90, 335.48, 336.07, 336.66, 337.24, 337.83, 338.42, 339.00, 339.59, 340.18,
  340.76, 341.35, 341.94, 342.52, 343.11, 343.70, 344.28, 344.87, 345.45, 346.04,
  346.63, 347.21, 347.80, 348.39, 348.97, 349.56, 350.15, 350.73, 351.32, 351.91,
  352.49, 353.08, 353.67, 354.25, 354.84, 355.43, 356.01, 356.60, 357.18, 357.77,
  358.36, 358.94, 359.53, 360.12, 360.70, 361.29, 361.88, 362.46, 363.05, 363.64,
  364.22, 364.81, 365.40, 365.98, 366.57, 367.16, 367.74, 368.33, 368.91, 369.50,
  370.09, 370.67, 371.26, 371.85, 372.43, 373.02, 373.61, 374.19, 374.78, 375.37,
  375.95, 376.54, 377.13, 377.71, 378.30, 378.89, 379.47, 380.06, 380.65, 381.23,
  381.82, 382.40, 382.99, 383.58, 384.16, 384.75, 385.34, 385.92, 386.51, 387.10,
  387.68, 388.27, 388.86, 389.44, 390.03, 390.62, 391.20, 391.79, 392.38, 392.96,
  393.55, 394.13, 394.72, 395.31, 395.89, 396.48, 397.07, 397.65, 398.24, 398.83,
  399.41, 400.00, 400.59, 401.17, 401.76, 402.35, 402.93, 403.52, 404.11, 404.69,
  405.28, 405.87, 406.45, 407.04, 407.62, 408.21, 408.80, 409.38, 409.97, 410.56,
  411.14, 411.73, 412.32, 412.90, 413.49, 414.08, 414.66, 415.25, 415.84, 416.42,
  417.01, 417.60, 418.18, 418.77, 419.35, 419.94, 420.53, 421.11, 421.70, 422.29,
  422.87, 423.46, 424.05, 424.63, 425.22, 425.81, 426.39, 426.98, 427.57, 428.15,
  428.74, 429.33, 429.91, 430.50, 431.09, 431.67, 432.26, 432.84, 433.43, 434.02,
  434.60, 435.19, 435.78, 436.36, 436.95, 437.54, 438.12, 438.71, 439.30, 439.88,
  440.47, 441.06, 441.64, 442.23, 442.82, 443.40, 443.99, 444.57, 445.16, 445.75,
  446.33, 446.92, 447.51, 448.09, 448.68, 449.27, 449.85, 450.44, 451.03, 451.61,
  452.20, 452.79, 453.37, 453.96, 454.55, 455.13, 455.72, 456.31, 456.89, 457.48,
  458.06, 458.65, 459.24, 459.82, 460.41, 461.00, 461.58, 462.17, 462.76, 463.34,
  463.93, 464.52, 465.10, 465.69, 466.28, 466.86, 467.45, 468.04, 468.62, 469.21,
  469.79, 470.38, 470.97, 471.55, 472.14, 472.73, 473.31, 473.90, 474.49, 475.07,
  475.66, 476.25, 476.83, 477.42, 478.01, 478.59, 479.18, 479.77, 480.35, 480.94,
  481.52, 482.11, 482.70, 483.28, 483.87, 484.46, 485.04, 485.63, 486.22, 486.80,
  487.39, 487.98, 488.56, 489.15, 489.74, 490.32, 490.91, 491.50, 492.08, 492.67,
  493.26, 493.84, 494.43, 495.01, 495.60, 496.19, 496.77, 497.36, 497.95, 498.53,
  499.12, 499.71, 500.29, 500.88, 501.47, 502.05, 502.64, 503.23, 503.81, 504.40,
  504.99, 505.57, 506.16, 506.74, 507.33, 507.92, 508.50, 509.09, 509.68, 510.26,
  510.85, 511.44, 512.02, 512.61, 513.20, 513.78, 514.37, 514.96, 515.54, 516.13,
  516.72, 517.30, 517.89, 518.48, 519.06, 519.65, 520.23, 520.82, 521.41, 521.99,
  522.58, 523.17, 523.75, 524.34, 524.93, 525.51, 526.10, 526.69, 527.27, 527.86,
  528.45, 529.03, 529.62, 530.21, 530.79, 531.38, 531.96, 532.55, 533.14, 533.72,
  534.31, 534.90, 535.48, 536.07, 536.66, 537.24, 537.83, 538.42, 539.00, 539.59,
  540.18, 540.76, 541.35, 541.94, 542.52, 543.11, 543.70, 544.28, 544.87, 545.45,
  546.04, 546.63, 547.21, 547.80, 548.39, 548.97, 549.56, 550.15, 550.73, 551.32,
  551.91, 552.49, 553.08, 553.67, 554.25, 554.84, 555.43, 556.01, 556.60, 557.18,
  557.77, 558.36, 558.94, 559.53, 560.12, 560.70, 561.29, 561.88, 562.46, 563.05,
  563.64, 564.22, 564.81, 565.40, 565.98, 566.57, 567.16, 567.74, 568.33, 568.91,
  569.50, 570.09, 570.67, 571.26, 571.85, 572.43, 573.02, 573.61, 574.19, 574.78,
  575.37, 575.95, 576.54, 577.13, 577.71, 578.30, 578.89, 579.47, 580.06, 580.65,
  581.23, 581.82, 582.40, 582.99, 583.58, 584.16, 584.75, 585.34, 585.92, 586.51,
  587.10, 587.68, 588.27, 588.86, 589.44, 590.03, 590.62, 591.20, 591.79, 592.38,
  592.96, 593.55, 594.13, 594.72, 595.31, 595.89, 596.48, 597.07, 597.65, 598.24,
  598.83, 599.41, 600.00
};

// Current lookup table
const float cur_table[] PROGMEM = {
  0.00,
  0.00, 0.01, 0.01, 0.02, 0.02, 0.03, 0.03, 0.04, 0.04, 0.05,
  0.05, 0.06, 0.06, 0.07, 0.07, 0.08, 0.08, 0.09, 0.09, 0.10,
  0.10, 0.11, 0.11, 0.12, 0.12, 0.13, 0.13, 0.14, 0.14, 0.15,
  0.15, 0.16, 0.16, 0.17, 0.17, 0.18, 0.18, 0.19, 0.19, 0.20,
  0.20, 0.21, 0.21, 0.22, 0.22, 0.22, 0.23, 0.23, 0.24, 0.24,
  0.25, 0.25, 0.26, 0.26, 0.27, 0.27, 0.28, 0.28, 0.29, 0.29,
  0.30, 0.30, 0.31, 0.31, 0.32, 0.32, 0.33, 0.33, 0.34, 0.34,
  0.35, 0.35, 0.36, 0.36, 0.37, 0.37, 0.38, 0.38, 0.39, 0.39,
  0.40, 0.40, 0.41, 0.41, 0.42, 0.42, 0.43, 0.43, 0.43, 0.44,
  0.44, 0.45, 0.45, 0.46, 0.46, 0.47, 0.47, 0.48, 0.48, 0.49,
  0.49, 0.50, 0.50, 0.51, 0.51, 0.52, 0.52, 0.53, 0.53, 0.54,
  0.54, 0.55, 0.55, 0.56, 0.56, 0.57, 0.57, 0.58, 0.58, 0.59,
  0.59, 0.60, 0.60, 0.61, 0.61, 0.62, 0.62, 0.63, 0.63, 0.64,
  0.64, 0.65, 0.65, 0.65, 0.66, 0.66, 0.67, 0.67, 0.68, 0.68,
  0.69, 0.69, 0.70, 0.70, 0.71, 0.71, 0.72, 0.72, 0.73, 0.73,
  0.74, 0.74, 0.75, 0.75, 0.76, 0.76, 0.77, 0.77, 0.78, 0.78,
  0.79, 0.79, 0.80, 0.80, 0.81, 0.81, 0.82, 0.82, 0.83, 0.83,
  0.84, 0.84, 0.85, 0.85, 0.86, 0.86, 0.87, 0.87, 0.87, 0.88,
  0.88, 0.89, 0.89, 0.90, 0.90, 0.91, 0.91, 0.92, 0.92, 0.93,
  0.93, 0.94, 0.94, 0.95, 0.95, 0.96, 0.96, 0.97, 0.97, 0.98,
  0.98, 0.99, 0.99, 1.00, 1.00, 1.01, 1.01, 1.02, 1.02, 1.03,
  1.03, 1.04, 1.04, 1.05, 1.05, 1.06, 1.06, 1.07, 1.07, 1.08,
  1.08, 1.09, 1.09, 1.09, 1.10, 1.10, 1.11, 1.11, 1.12, 1.12,
  1.13, 1.13, 1.14, 1.14, 1.15, 1.15, 1.16, 1.16, 1.17, 1.17,
  1.18, 1.18, 1.19, 1.19, 1.20, 1.20, 1.21, 1.21, 1.22, 1.22,
  1.23, 1.23, 1.24, 1.24, 1.25, 1.25, 1.26, 1.26, 1.27, 1.27,
  1.28, 1.28, 1.29, 1.29, 1.30, 1.30, 1.30, 1.31, 1.31, 1.32,
  1.32, 1.33, 1.33, 1.34, 1.34, 1.35, 1.35, 1.36, 1.36, 1.37,
  1.37, 1.38, 1.38, 1.39, 1.39, 1.40, 1.40, 1.41, 1.41, 1.42,
  1.42, 1.43, 1.43, 1.44, 1.44, 1.45, 1.45, 1.46, 1.46, 1.47,
  1.47, 1.48, 1.48, 1.49, 1.49, 1.50, 1.50, 1.51, 1.51, 1.52,
  1.52, 1.52, 1.53, 1.53, 1.54, 1.54, 1.55, 1.55, 1.56, 1.56,
  1.57, 1.57, 1.58, 1.58, 1.59, 1.59, 1.60, 1.60, 1.61, 1.61,
  1.62, 1.62, 1.63, 1.63, 1.64, 1.64, 1.65, 1.65, 1.66, 1.66,
  1.67, 1.67, 1.68, 1.68, 1.69, 1.69, 1.70, 1.70, 1.71, 1.71,
  1.72, 1.72, 1.73, 1.73, 1.74, 1.74, 1.74, 1.75, 1.75, 1.76,
  1.76, 1.77, 1.77, 1.78, 1.78, 1.79, 1.79, 1.80, 1.80, 1.81,
  1.81, 1.82, 1.82, 1.83, 1.83, 1.84, 1.84, 1.85, 1.85, 1.86,
  1.86, 1.87, 1.87, 1.88, 1.88, 1.89, 1.89, 1.90, 1.90, 1.91,
  1.91, 1.92, 1.92, 1.93, 1.93, 1.94, 1.94, 1.95, 1.95, 1.96,
  1.96, 1.96, 1.97, 1.97, 1.98, 1.98, 1.99, 1.99, 2.00, 2.00,
  2.01, 2.01, 2.02, 2.02, 2.03, 2.03, 2.04, 2.04, 2.05, 2.05,
  2.06, 2.06, 2.07, 2.07, 2.08, 2.08, 2.09, 2.09, 2.10, 2.10,
  2.11, 2.11, 2.12, 2.12, 2.13, 2.13, 2.14, 2.14, 2.15, 2.15,
  2.16, 2.16, 2.17, 2.17, 2.17, 2.18, 2.18, 2.19, 2.19, 2.20,
  2.20, 2.21, 2.21, 2.22, 2.22, 2.23, 2.23, 2.24, 2.24, 2.25,
  2.25, 2.26, 2.26, 2.27, 2.27, 2.28, 2.28, 2.29, 2.29, 2.30,
  2.30, 2.31, 2.31, 2.32, 2.32, 2.33, 2.33, 2.34, 2.34, 2.35,
  2.35, 2.36, 2.36, 2.37, 2.37, 2.38, 2.38, 2.39, 2.39, 2.39,
  2.40, 2.40, 2.41, 2.41, 2.42, 2.42, 2.43, 2.43, 2.44, 2.44,
  2.45, 2.45, 2.46, 2.46, 2.47, 2.47, 2.48, 2.48, 2.49, 2.49,
  2.50, 2.50, 2.51, 2.51, 2.52, 2.52, 2.53, 2.53, 2.54, 2.54,
  2.55, 2.55, 2.56, 2.56, 2.57, 2.57, 2.58, 2.58, 2.59, 2.59,
  2.60, 2.60, 2.61, 2.61, 2.61, 2.62, 2.62, 2.63, 2.63, 2.64,
  2.64, 2.65, 2.65, 2.66, 2.66, 2.67, 2.67, 2.68, 2.68, 2.69,
  2.69, 2.70, 2.70, 2.71, 2.71, 2.72, 2.72, 2.73, 2.73, 2.74,
  2.74, 2.75, 2.75, 2.76, 2.76, 2.77, 2.77, 2.78, 2.78, 2.79,
  2.79, 2.80, 2.80, 2.81, 2.81, 2.82, 2.82, 2.83, 2.83, 2.83,
  2.84, 2.84, 2.85, 2.85, 2.86, 2.86, 2.87, 2.87, 2.88, 2.88,
  2.89, 2.89, 2.90, 2.90, 2.91, 2.91, 2.92, 2.92, 2.93, 2.93,
  2.94, 2.94, 2.95, 2.95, 2.96, 2.96, 2.97, 2.97, 2.98, 2.98,
  2.99, 2.99, 3.00, 3.00, 3.01, 3.01, 3.02, 3.02, 3.03, 3.03,
  3.04, 3.04, 3.04, 3.05, 3.05, 3.06, 3.06, 3.07, 3.07, 3.08,
  3.08, 3.09, 3.09, 3.10, 3.10, 3.11, 3.11, 3.12, 3.12, 3.13,
  3.13, 3.14, 3.14, 3.15, 3.15, 3.16, 3.16, 3.17, 3.17, 3.18,
  3.18, 3.19, 3.19, 3.20, 3.20, 3.21, 3.21, 3.22, 3.22, 3.23,
  3.23, 3.24, 3.24, 3.25, 3.25, 3.26, 3.26, 3.26, 3.27, 3.27,
  3.28, 3.28, 3.29, 3.29, 3.30, 3.30, 3.31, 3.31, 3.32, 3.32,
  3.33, 3.33, 3.34, 3.34, 3.35, 3.35, 3.36, 3.36, 3.37, 3.37,
  3.38, 3.38, 3.39, 3.39, 3.40, 3.40, 3.41, 3.41, 3.42, 3.42,
  3.43, 3.43, 3.44, 3.44, 3.45, 3.45, 3.46, 3.46, 3.47, 3.47,
  3.48, 3.48, 3.48, 3.49, 3.49, 3.50, 3.50, 3.51, 3.51, 3.52,
  3.52, 3.53, 3.53, 3.54, 3.54, 3.55, 3.55, 3.56, 3.56, 3.57,
  3.57, 3.58, 3.58, 3.59, 3.59, 3.60, 3.60, 3.61, 3.61, 3.62,
  3.62, 3.63, 3.63, 3.64, 3.64, 3.65, 3.65, 3.66, 3.66, 3.67,
  3.67, 3.68, 3.68, 3.69, 3.69, 3.70, 3.70, 3.70, 3.71, 3.71,
  3.72, 3.72, 3.73, 3.73, 3.74, 3.74, 3.75, 3.75, 3.76, 3.76,
  3.77, 3.77, 3.78, 3.78, 3.79, 3.79, 3.80, 3.80, 3.81, 3.81,
  3.82, 3.82, 3.83, 3.83, 3.84, 3.84, 3.85, 3.85, 3.86, 3.86,
  3.87, 3.87, 3.88, 3.88, 3.89, 3.89, 3.90, 3.90, 3.91, 3.91,
  3.91, 3.92, 3.92, 3.93, 3.93, 3.94, 3.94, 3.95, 3.95, 3.96,
  3.96, 3.97, 3.97, 3.98, 3.98, 3.99, 3.99, 4.00, 4.00, 4.01,
  4.01, 4.02, 4.02, 4.03, 4.03, 4.04, 4.04, 4.05, 4.05, 4.06,
  4.06, 4.07, 4.07, 4.08, 4.08, 4.09, 4.09, 4.10, 4.10, 4.11,
  4.11, 4.12, 4.12, 4.13, 4.13, 4.13, 4.14, 4.14, 4.15, 4.15,
  4.16, 4.16, 4.17, 4.17, 4.18, 4.18, 4.19, 4.19, 4.20, 4.20,
  4.21, 4.21, 4.22, 4.22, 4.23, 4.23, 4.24, 4.24, 4.25, 4.25,
  4.26, 4.26, 4.27, 4.27, 4.28, 4.28, 4.29, 4.29, 4.30, 4.30,
  4.31, 4.31, 4.32, 4.32, 4.33, 4.33, 4.34, 4.34, 4.35, 4.35,
  4.35, 4.36, 4.36, 4.37, 4.37, 4.38, 4.38, 4.39, 4.39, 4.40,
  4.40, 4.41, 4.41, 4.42, 4.42, 4.43, 4.43, 4.44, 4.44, 4.45,
  4.45, 4.46, 4.46, 4.47, 4.47, 4.48, 4.48, 4.49, 4.49, 4.50,
  4.50, 4.51, 4.51, 4.52, 4.52, 4.53, 4.53, 4.54, 4.54, 4.55,
  4.55, 4.56, 4.56, 4.57, 4.57, 4.57, 4.58, 4.58, 4.59, 4.59,
  4.60, 4.60, 4.61, 4.61, 4.62, 4.62, 4.63, 4.63, 4.64, 4.64,
  4.65, 4.65, 4.66, 4.66, 4.67, 4.67, 4.68, 4.68, 4.69, 4.69,
  4.70, 4.70, 4.71, 4.71, 4.72, 4.72, 4.73, 4.73, 4.74, 4.74,
  4.75, 4.75, 4.76, 4.76, 4.77, 4.77, 4.78, 4.78, 4.78, 4.79,
  4.79, 4.80, 4.80, 4.81, 4.81, 4.82, 4.82, 4.83, 4.83, 4.84,
  4.84, 4.85, 4.85, 4.86, 4.86, 4.87, 4.87, 4.88, 4.88, 4.89,
  4.89, 4.90, 4.90, 4.91, 4.91, 4.92, 4.92, 4.93, 4.93, 4.94,
  4.94, 4.95, 4.95, 4.96, 4.96, 4.97, 4.97, 4.98, 4.98, 4.99,
  4.99, 5.00, 5.00
};

// Define the Pins
int voltage = A0; // Select the input pin for the voltage sensor
int current1 = A1; // Select the input pin for the current sensor #1
int voltageValue = 0; // Variable to store the value coming from the voltage sensor
int current1Value = 0; // Variable to store the value coming from the current sensor #1
float curtrip = 3.00;
int ledPin = 9;
int relayPin = 8;

int ee_curtrip = 0;    // EEPROM address for max current.
float MaxCur = 5.00;   // Define the max current. Needs to be a whole number.

int ButtonA = 10;      // Button A - Digital pin 10 
int ButtonB = 11;      // Button B - Digital pin 11


void setup() {
  
  pinMode(ledPin, OUTPUT);
  pinMode(relayPin, OUTPUT);

  // Enable the pull up restace for the buttons
  pinMode(ButtonA, INPUT_PULLUP);
  pinMode(ButtonB, INPUT_PULLUP);

  // Get the saved max curent from EEPROM.
  EEPROM.get(ee_curtrip,curtrip);

  /* Test EEPROM values for the correct range.
   *  
   * The EEPROM is empty (NAN) when the sketch is run
   * on a microprocessor that had it's EEPROM
   * erased. When a microprocessor is recycled there
   * is no way of knowing what values are stored in 
   * the EEPROM. The tests are need because I am not 
   * aware of any way Arduino can directly initialize  
   * EEPROM values. 
  */ 
  if ( isnan(curtrip) ) { curtrip = MaxCur; }
  if ( curtrip < 0.01)  { curtrip = 0.01; }
  if ( curtrip > MaxCur ) { curtrip = MaxCur; }

  // Set up the LCD's number of columns and rows:
  lcd.begin(16, 2);  // initialize the lcd

  // Startup Message
  lcd.clear();  // clear lcd
  lcd.setCursor(0,0);
  lcd.print("TDA -- Speciosus");
  lcd.setCursor(1, 1);
  lcd.print("Variac Monitor");
  delay(2000);

  // Display current limit recovered from EEPROM
  lcd.clear();
  lcd.setCursor(1,0);
  lcd.print("Current Limit");
  lcd.setCursor(6,1);
  lcd.print(curtrip);

  digitalWrite(ledPin, LOW);
  digitalWrite (relayPin, LOW);

  delay(3000);
}

void loop() {
  voltageValue = analogRead(voltage);
  current1Value = analogRead(current1);
  //float vol = (voltageValue * (5.00/1023.0))*120;
  //float cur1 = current1Value * (5.00/1023.0);
  float vol = pgm_read_float(&vol_table[voltageValue]);
  float cur1 = pgm_read_float(&cur_table[current1Value]);

  char volLCDString[16];

  int ButtonAStatus[2];

  // Set the cursor to column 0, line 0
  if (cur1 < curtrip) {
    digitalWrite(ledPin, LOW);
    digitalWrite (relayPin, HIGH);
    lcd.clear();
    // read and display the voltage
    lcd.setCursor(0, 0);
    lcd.print("Vol=");
    lcd.setCursor(5, 0);
    // Format Vol value for LCD display. 
    dtostrf(vol,6,2,volLCDString);
    lcd.print(volLCDString);

    // Read and display the current
    lcd.setCursor(0, 1);
    lcd.print("Cur=");
    lcd.setCursor(7, 1);
    lcd.print(cur1);
    delay(500);
  }
  else {
    while (1) {
      digitalWrite(ledPin, HIGH);
      digitalWrite(relayPin, LOW);
      lcd.clear();
      lcd.setCursor(0, 0);
      lcd.print("Tripped Over Cur");
      lcd.setCursor(0, 1);
      lcd.print("Press Reset");
      delay(1000);
    }
  }

  Test_A_Button(ButtonAStatus);
  if ( ButtonAStatus[0] == 1) {
     ButtonAStatus[0] = 0; 
     Current_Set_Menu();
  } 
           
}

/* 1st push A display Menu - B button exit 
 * 2nd push A Curser on Amp - B button inc AMP
 * 3rd push A Curser on deci Amp - B button inc deci Amp
 * 4th push A Curser on centi Amp - B button inc centi Amp
 * 5th Push A exit Menu
 * -The cursor blinks on the decimal point that is 
 *  changed by buttuon B.
 */
void Current_Set_Menu() {
    int InMenu = 1;
    int ButtonAStatusLocal[2];
    int ButtonBStatusLocal[2];    
    int test;

    while (InMenu) {
       lcd.clear();
       lcd.setCursor(1,0);
       lcd.print("Current Limit");
       lcd.setCursor(6,1);
       lcd.print(curtrip);

       switch (InMenu) {
         case 2:
             lcd.setCursor(6,1);
             lcd.blink();    
             break;
         case 3:
             lcd.setCursor(8,1);
             lcd.blink();    
             break;
         case 4:
             lcd.setCursor(9,1);
             lcd.blink();    
             break;                          
          default:
             break;
       }
       
       delay(200);


       Test_A_Button(ButtonAStatusLocal);
       Test_B_Button(ButtonBStatusLocal);       

        if  ( ButtonAStatusLocal[0] == 1 ) {
          ButtonAStatusLocal[0] = 0;
          InMenu++;
        }

        if (InMenu == 1 ) {
           if ( ButtonBStatusLocal[0] == 1 ) {
              ButtonBStatusLocal[0] = 0;
              InMenu = 0;
           }
        }

        if (InMenu == 2 ) {
           if ( ButtonBStatusLocal[0] == 1 ) {
              ButtonBStatusLocal[0] = 0;
              if ( curtrip >= MaxCur ) {
                 curtrip = curtrip - 5;
              } else {
                 curtrip = curtrip + 1;                
              }
           }
        }
        
        if (InMenu == 3 ) {
           if ( int(curtrip)%10 >= int(MaxCur) ) {
              curtrip = MaxCur;  
              continue; 
           }
           
           if ( ButtonBStatusLocal[0] == 1 ) {
              ButtonBStatusLocal[0] = 0;
              curtrip = curtrip + 0.1;                            
           }
        }

        if (InMenu == 4 ) {
           if ( int(curtrip)%10 >= int(MaxCur) ) { 
              curtrip = MaxCur;
              continue; 
           }

           
           if ( ButtonBStatusLocal[0] == 1 ) {
              ButtonBStatusLocal[0] = 0;
              curtrip = curtrip + 0.01;         
           }           
        }
        
        // Exit Menu
        if ( InMenu >= 5 ) {
           InMenu = 0;
           lcd.noBlink();
           // Make sure that the curent limit can not be zero. 
           if (curtrip <= 0.00) {
              curtrip = 0.01;  
           }
           // Save max current to EEPROM.
           EEPROM.put(ee_curtrip,curtrip);
           
        }   

  }

}

void Test_A_Button (int ButtonAStatus[] ) {

  // A button debounce 
  int buttonALocal = digitalRead(ButtonA);

  if (buttonALocal == 0 ) { // Down
      ButtonAStatus[1] = 1;
      ButtonAStatus[0] = 0;

  } else if ( buttonALocal && (ButtonAStatus[1] == 1) ) { // Up
      ButtonAStatus[1] = 0;
      ButtonAStatus[0] = 1;
      //Action here
  }   

}

void Test_B_Button (int ButtonBStatus[] ) {

  // B button debounce 
  int ButtonBLocal = digitalRead(ButtonB);

  if (ButtonBLocal == 0 ) { // Down
      ButtonBStatus[1] = 1;
      ButtonBStatus[0] = 0;

  } else if ( ButtonBLocal && (ButtonBStatus[1] == 1) ) { // Up
      ButtonBStatus[1] = 0;
      ButtonBStatus[0] = 1;
      //Action here
  }   
  
}


